<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../overview.html">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">iris.heap_lang.proofmode</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="iris.proofmode.coq_tactics.html#"><span class="id" title="library">coq_tactics</span></a> <a class="idref" href="iris.proofmode.reduction.html#"><span class="id" title="library">reduction</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="iris.proofmode.tactics.html#"><span class="id" title="library">tactics</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.program_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="iris.program_logic.atomic.html#"><span class="id" title="library">atomic</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.heap_lang</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="iris.heap_lang.tactics.html#"><span class="id" title="library">tactics</span></a> <a class="idref" href="iris.heap_lang.array.html#"><span class="id" title="library">array</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.heap_lang</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="iris.heap_lang.notation.html#"><span class="id" title="library">notation</span></a>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Default</span> <span class="id" title="keyword">Proof</span> <span class="id" title="var">Using</span> "Type".<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">uPred</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_wp_expr_eval"><span class="id" title="lemma">tac_wp_expr_eval</span></a> `{!<a class="idref" href="iris.heap_lang.lifting.html#heapG"><span class="id" title="class">heapG</span></a> <span class="id" title="var">Σ</span>} <span class="id" title="var">Δ</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">Φ</span> <span class="id" title="var">e</span> <span class="id" title="var">e'</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><span class="id" title="var">e''</span>:=<a class="idref" href="iris.heap_lang.proofmode.html#e'"><span class="id" title="variable">e'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e''"><span class="id" title="variable">e''</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e'"><span class="id" title="variable">e'</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> -&gt;. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_twp_expr_eval"><span class="id" title="lemma">tac_twp_expr_eval</span></a> `{!<a class="idref" href="iris.heap_lang.lifting.html#heapG"><span class="id" title="class">heapG</span></a> <span class="id" title="var">Σ</span>} <span class="id" title="var">Δ</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">Φ</span> <span class="id" title="var">e</span> <span class="id" title="var">e'</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><span class="id" title="var">e''</span>:=<a class="idref" href="iris.heap_lang.proofmode.html#e'"><span class="id" title="variable">e'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e''"><span class="id" title="variable">e''</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e'"><span class="id" title="variable">e'</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> -&gt;. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_expr_eval" <span class="id" title="var">tactic3</span>(<span class="id" title="var">t</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">iStartProof</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.proofmode.html#tac_wp_expr_eval"><span class="id" title="lemma">tac_wp_expr_eval</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="keyword">let</span> <span class="id" title="var">x</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span> <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="var">t</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">reflexivity</span>|]<br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.proofmode.html#tac_twp_expr_eval"><span class="id" title="lemma">tac_twp_expr_eval</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="keyword">let</span> <span class="id" title="var">x</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span> <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="var">t</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">reflexivity</span>|]<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_expr_eval: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_wp_pure"><span class="id" title="lemma">tac_wp_pure</span></a> `{!<a class="idref" href="iris.heap_lang.lifting.html#heapG"><span class="id" title="class">heapG</span></a> <span class="id" title="var">Σ</span>} <span class="id" title="var">Δ</span> <span class="id" title="var">Δ'</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> φ <span class="id" title="var">n</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.program_logic.language.html#PureExec"><span class="id" title="class">PureExec</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#7f48d4a68765673379b41e1b1ee20edf"><span class="id" title="variable">φ</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proofmode.html#7f48d4a68765673379b41e1b1ee20edf"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ??? <span class="id" title="var">HΔ'</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">HΔ'</span> -<a class="idref" href="iris.program_logic.lifting.html#wp_pure_step_later"><span class="id" title="lemma">lifting.wp_pure_step_later</span></a> //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_twp_pure"><span class="id" title="lemma">tac_twp_pure</span></a> `{!<a class="idref" href="iris.heap_lang.lifting.html#heapG"><span class="id" title="class">heapG</span></a> <span class="id" title="var">Σ</span>} <span class="id" title="var">Δ</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> φ <span class="id" title="var">n</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.program_logic.language.html#PureExec"><span class="id" title="class">PureExec</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#7f48d4a68765673379b41e1b1ee20edf"><span class="id" title="variable">φ</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proofmode.html#7f48d4a68765673379b41e1b1ee20edf"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ?? -&gt;. <span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.total_lifting.html#twp_pure_step"><span class="id" title="lemma">total_lifting.twp_pure_step</span></a> //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_wp_value"><span class="id" title="lemma">tac_wp_value</span></a> `{!<a class="idref" href="iris.heap_lang.lifting.html#heapG"><span class="id" title="class">heapG</span></a> <span class="id" title="var">Σ</span>} <span class="id" title="var">Δ</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">Φ</span> <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">(</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">)</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; -&gt;. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.weakestpre.html#wp_value"><span class="id" title="lemma">wp_value</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_twp_value"><span class="id" title="lemma">tac_twp_value</span></a> `{!<a class="idref" href="iris.heap_lang.lifting.html#heapG"><span class="id" title="class">heapG</span></a> <span class="id" title="var">Σ</span>} <span class="id" title="var">Δ</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">Φ</span> <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">(</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">)</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; -&gt;. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.total_weakestpre.html#twp_value"><span class="id" title="lemma">twp_value</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">wp_expr_simpl</span> := <span class="id" title="var">wp_expr_eval</span> <span class="id" title="tactic">simpl</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">wp_value_head</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">first</span> [<span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.proofmode.html#tac_wp_value"><span class="id" title="lemma">tac_wp_value</span></a> || <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.proofmode.html#tac_twp_value"><span class="id" title="lemma">tac_twp_value</span></a>].<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">wp_finish</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">wp_expr_simpl</span>;      <span class="comment">(*&nbsp;simplify&nbsp;occurences&nbsp;of&nbsp;subst/fill&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">wp_value_head</span>;  <span class="comment">(*&nbsp;in&nbsp;case&nbsp;we&nbsp;have&nbsp;reached&nbsp;a&nbsp;value,&nbsp;get&nbsp;rid&nbsp;of&nbsp;the&nbsp;WP&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">pm_prettify</span>. <span class="comment">(*&nbsp;prettify&nbsp;▷s&nbsp;caused&nbsp;by&nbsp;<span class="inlinecode"><span class="id" title="var">MaybeIntoLaterNEnvs</span></span>&nbsp;and<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;λs&nbsp;caused&nbsp;by&nbsp;wp_value&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">solve_vals_compare_safe</span> :=<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;first&nbsp;branch&nbsp;is&nbsp;for&nbsp;when&nbsp;we&nbsp;have&nbsp;<span class="inlinecode"><span class="id" title="var">vals_compare_safe</span></span>&nbsp;in&nbsp;the&nbsp;context.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;other&nbsp;two&nbsp;branches&nbsp;are&nbsp;for&nbsp;when&nbsp;either&nbsp;one&nbsp;of&nbsp;the&nbsp;branches&nbsp;reduces&nbsp;to<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="var">True</span></span>&nbsp;or&nbsp;we&nbsp;have&nbsp;it&nbsp;in&nbsp;the&nbsp;context.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">fast_done</span> || (<span class="id" title="tactic">left</span>; <span class="id" title="var">fast_done</span>) || (<span class="id" title="tactic">right</span>; <span class="id" title="var">fast_done</span>).<br/>

<br/>
</div>

<div class="doc">
The argument <span class="inlinecode"><span class="id" title="var">efoc</span></span> can be used to specify the construct that should be
reduced. For example, you can write <span class="inlinecode"><span class="id" title="var">wp_pure</span></span> <span class="inlinecode">(<span class="id" title="var">EIf</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span>)</span>, which will search
for an <span class="inlinecode"><span class="id" title="var">EIf</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> in the expression, and reduce it.

<div class="paragraph"> </div>

The use of <span class="inlinecode"><span class="id" title="var">open_constr</span></span> in this tactic is essential. It will convert all holes
(i.e. <span class="inlinecode"><span class="id" title="var">_</span></span>s) into evars, that later get unified when an occurences is found
(see <span class="inlinecode"><span class="id" title="var">unify</span></span> <span class="inlinecode"><a class="idref" href="iris.bi.tactics.html#e'"><span class="id" title="variable">e'</span></a></span> <span class="inlinecode"><span class="id" title="var">efoc</span></span> in the code below). 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "wp_pure" <span class="id" title="var">open_constr</span>(<span class="id" title="var">efoc</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">iStartProof</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">e</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unify</span> <span class="id" title="var">e'</span> <span class="id" title="var">efoc</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_wp_pure"><span class="id" title="lemma">tac_wp_pure</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <span class="id" title="var">e'</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span>                       <span class="comment">(*&nbsp;PureExec&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> <span class="id" title="var">solve_vals_compare_safe</span>    <span class="comment">(*&nbsp;The&nbsp;pure&nbsp;condition&nbsp;for&nbsp;PureExec&nbsp;--&nbsp;handles&nbsp;trivial&nbsp;goals,&nbsp;including&nbsp;<span class="inlinecode"><span class="id" title="var">vals_compare_safe</span></span>&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">iSolveTC</span>                       <span class="comment">(*&nbsp;IntoLaters&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">wp_finish</span>                      <span class="comment">(*&nbsp;new&nbsp;goal&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id" title="tactic">fail</span> "wp_pure: cannot find" <span class="id" title="var">efoc</span> "in" <span class="id" title="var">e</span> "or" <span class="id" title="var">efoc</span> "is not a redex"<br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">e</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unify</span> <span class="id" title="var">e'</span> <span class="id" title="var">efoc</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_twp_pure"><span class="id" title="lemma">tac_twp_pure</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <span class="id" title="var">e'</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span>                       <span class="comment">(*&nbsp;PureExec&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> <span class="id" title="var">fast_done</span>                  <span class="comment">(*&nbsp;The&nbsp;pure&nbsp;condition&nbsp;for&nbsp;PureExec&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">wp_finish</span>                      <span class="comment">(*&nbsp;new&nbsp;goal&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id" title="tactic">fail</span> "wp_pure: cannot find" <span class="id" title="var">efoc</span> "in" <span class="id" title="var">e</span> "or" <span class="id" title="var">efoc</span> "is not a redex"<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_pure: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;do&nbsp;this&nbsp;in&nbsp;one&nbsp;go,&nbsp;without&nbsp;<span class="inlinecode"><span class="id" title="tactic">repeat</span></span>.&nbsp;*)</span><br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">wp_pures</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">iStartProof</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="var">wp_pure</span> <span class="id" title="var">_</span>; []). <span class="comment">(*&nbsp;The&nbsp;`;<span class="inlinecode"></span>`&nbsp;makes&nbsp;sure&nbsp;that&nbsp;no&nbsp;side-condition<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;magically&nbsp;spawns.&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
Unlike <span class="inlinecode"><span class="id" title="var">wp_pures</span></span>, the tactics <span class="inlinecode"><span class="id" title="var">wp_rec</span></span> and <span class="inlinecode"><span class="id" title="var">wp_lam</span></span> should also reduce
lambdas/recs that are hidden behind a definition, i.e. they should use
<span class="inlinecode"><a class="idref" href="iris.heap_lang.lifting.html#AsRecV_recv"><span class="id" title="definition">AsRecV_recv</span></a></span> as a proper instance instead of a <span class="inlinecode"><span class="id" title="keyword">Hint</span></span> <span class="inlinecode"><span class="id" title="keyword">Extern</span></span>.

<div class="paragraph"> </div>

We achieve this by putting <span class="inlinecode"><a class="idref" href="iris.heap_lang.lifting.html#AsRecV_recv"><span class="id" title="definition">AsRecV_recv</span></a></span> in the current environment so that it
can be used as an instance by the typeclass resolution system. We then perform
the reduction, and finally we clear this new hypothesis. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "wp_rec" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H</span> := <a class="idref" href="iris.heap_lang.lifting.html#AsRecV_recv"><span class="id" title="definition">AsRecV_recv</span></a>);<br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pure</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.App"><span class="id" title="constructor">App</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_if" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.If"><span class="id" title="constructor">If</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_if_true" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.If"><span class="id" title="constructor">If</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>)) <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_if_false" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.If"><span class="id" title="constructor">If</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>)) <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_unop" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.UnOp"><span class="id" title="constructor">UnOp</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_binop" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.BinOp"><span class="id" title="constructor">BinOp</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_op" := <span class="id" title="var">wp_unop</span> || <span class="id" title="var">wp_binop</span>.<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_lam" := <span class="id" title="var">wp_rec</span>.<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_let" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Rec"><span class="id" title="constructor">Rec</span></a> <a class="idref" href="../html-stdpp/stdpp.binders.html#BAnon"><span class="id" title="constructor">BAnon</span></a> (<a class="idref" href="../html-stdpp/stdpp.binders.html#BNamed"><span class="id" title="constructor">BNamed</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">_</span>); <span class="id" title="var">wp_lam</span>.<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_seq" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Rec"><span class="id" title="constructor">Rec</span></a> <a class="idref" href="../html-stdpp/stdpp.binders.html#BAnon"><span class="id" title="constructor">BAnon</span></a> <a class="idref" href="../html-stdpp/stdpp.binders.html#BAnon"><span class="id" title="constructor">BAnon</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">wp_lam</span>.<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_proj" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Fst"><span class="id" title="constructor">Fst</span></a> <span class="id" title="var">_</span>) || <span class="id" title="var">wp_pure</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Snd"><span class="id" title="constructor">Snd</span></a> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_case" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Case"><span class="id" title="constructor">Case</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_match" := <span class="id" title="var">wp_case</span>; <span class="id" title="var">wp_pure</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Rec"><span class="id" title="constructor">Rec</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="var">wp_lam</span>.<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_inj" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.InjL"><span class="id" title="constructor">InjL</span></a> <span class="id" title="var">_</span>) || <span class="id" title="var">wp_pure</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.InjR"><span class="id" title="constructor">InjR</span></a> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_pair" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Pair"><span class="id" title="constructor">Pair</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_closure" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Rec"><span class="id" title="constructor">Rec</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_wp_bind"><span class="id" title="lemma">tac_wp_bind</span></a> `{!<a class="idref" href="iris.heap_lang.lifting.html#heapG"><span class="id" title="class">heapG</span></a> <span class="id" title="var">Σ</span>} <span class="id" title="var">K</span> <span class="id" title="var">Δ</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">Φ</span> <span class="id" title="var">e</span> <span class="id" title="var">f</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proofmode.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <span class="id" title="var">e</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="comment">(*&nbsp;as&nbsp;an&nbsp;eta&nbsp;expanded&nbsp;hypothesis&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;`simpl`&nbsp;it&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#eee60bb71eb20943eabf98b71ebd06b9"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="iris.bi.weakestpre.html#eee60bb71eb20943eabf98b71ebd06b9"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#eee60bb71eb20943eabf98b71ebd06b9"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#eee60bb71eb20943eabf98b71ebd06b9"><span class="id" title="notation">{{</span></a> <span class="id" title="var">v</span><a class="idref" href="iris.bi.weakestpre.html#eee60bb71eb20943eabf98b71ebd06b9"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#f"><span class="id" title="variable">f</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a> <a class="idref" href="iris.bi.weakestpre.html#eee60bb71eb20943eabf98b71ebd06b9"><span class="id" title="notation">}}</span></a>)%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; -&gt; -&gt;. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <a class="idref" href="iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_twp_bind"><span class="id" title="lemma">tac_twp_bind</span></a> `{!<a class="idref" href="iris.heap_lang.lifting.html#heapG"><span class="id" title="class">heapG</span></a> <span class="id" title="var">Σ</span>} <span class="id" title="var">K</span> <span class="id" title="var">Δ</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">Φ</span> <span class="id" title="var">e</span> <span class="id" title="var">f</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proofmode.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <span class="id" title="var">e</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="comment">(*&nbsp;as&nbsp;an&nbsp;eta&nbsp;expanded&nbsp;hypothesis&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;`simpl`&nbsp;it&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#0197e84fdb0a191e588749e927e5eb27"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="iris.bi.weakestpre.html#0197e84fdb0a191e588749e927e5eb27"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#0197e84fdb0a191e588749e927e5eb27"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#0197e84fdb0a191e588749e927e5eb27"><span class="id" title="notation">[{</span></a> <span class="id" title="var">v</span><a class="idref" href="iris.bi.weakestpre.html#0197e84fdb0a191e588749e927e5eb27"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#f"><span class="id" title="variable">f</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a> <a class="idref" href="iris.bi.weakestpre.html#0197e84fdb0a191e588749e927e5eb27"><span class="id" title="notation">}]</span></a>)%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; -&gt; -&gt;. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <a class="idref" href="iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">wp_bind_core</span> <span class="id" title="var">K</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="tactic">eval</span> <span class="id" title="tactic">hnf</span> <span class="id" title="tactic">in</span> <span class="id" title="var">K</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_wp_bind"><span class="id" title="lemma">tac_wp_bind</span></a> <span class="id" title="var">K</span>); [<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">reflexivity</span>|<span class="id" title="var">reduction.pm_prettify</span>]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">twp_bind_core</span> <span class="id" title="var">K</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="tactic">eval</span> <span class="id" title="tactic">hnf</span> <span class="id" title="tactic">in</span> <span class="id" title="var">K</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_twp_bind"><span class="id" title="lemma">tac_twp_bind</span></a> <span class="id" title="var">K</span>); [<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">reflexivity</span>|<span class="id" title="var">reduction.pm_prettify</span>]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_bind" <span class="id" title="var">open_constr</span>(<span class="id" title="var">efoc</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">iStartProof</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="var">unify</span> <span class="id" title="var">e'</span> <span class="id" title="var">efoc</span>; <span class="id" title="var">wp_bind_core</span> <span class="id" title="var">K</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id" title="tactic">fail</span> "wp_bind: cannot find" <span class="id" title="var">efoc</span> "in" <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="var">unify</span> <span class="id" title="var">e'</span> <span class="id" title="var">efoc</span>; <span class="id" title="var">twp_bind_core</span> <span class="id" title="var">K</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id" title="tactic">fail</span> "wp_bind: cannot find" <span class="id" title="var">efoc</span> "in" <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_bind: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Heap tactics 
</div>
<div class="code">
<span class="id" title="keyword">Section</span> <a name="heap"><span class="id" title="section">heap</span></a>.<br/>
<span class="id" title="keyword">Context</span> `{!<a class="idref" href="iris.heap_lang.lifting.html#heapG"><span class="id" title="class">heapG</span></a> <span class="id" title="var">Σ</span>}.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <a class="idref" href="iris.base_logic.lib.iprop.html#iProp_solution.iProp"><span class="id" title="abbreviation">iProp</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#c075f1221d2d857b95ac7ce005336844"><span class="id" title="variable">Σ</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">Φ</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.base_logic.lib.iprop.html#iProp_solution.iProp"><span class="id" title="abbreviation">iProp</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#c075f1221d2d857b95ac7ce005336844"><span class="id" title="variable">Σ</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">Δ</span> : <a class="idref" href="iris.proofmode.environments.html#envs"><span class="id" title="record">envs</span></a> (<a class="idref" href="iris.base_logic.bi.html#uPredI"><span class="id" title="definition">uPredI</span></a> (<a class="idref" href="iris.base_logic.lib.iprop.html#iProp_solution.iResUR"><span class="id" title="definition">iResUR</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#c075f1221d2d857b95ac7ce005336844"><span class="id" title="variable">Σ</span></a>)).<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">z</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_wp_allocN"><span class="id" title="lemma">tac_wp_allocN</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">Δ'</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">j</span> <span class="id" title="var">K</span> <span class="id" title="var">v</span> <span class="id" title="var">n</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.ZArith.BinInt.html#143d73f5a64447681988da92e84a3de5"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> 1 <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <span class="id" title="var">l</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">Δ''</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_app"><span class="id" title="definition">envs_app</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#j"><span class="id" title="variable">j</span></a> (<a class="idref" href="iris.heap_lang.array.html#array"><span class="id" title="definition">array</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> 1 (<a class="idref" href="../html-stdpp/stdpp.list.html#replicate"><span class="id" title="definition">replicate</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#n"><span class="id" title="variable">n</span></a>) <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a>))) <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#4f19051cc735bc20f076e5561be97384"><span class="id" title="variable">Δ''</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#4f19051cc735bc20f076e5561be97384"><span class="id" title="variable">Δ''</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitLoc"><span class="id" title="constructor">LitLoc</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.AllocN"><span class="id" title="constructor">AllocN</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitInt"><span class="id" title="constructor">LitInt</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#n"><span class="id" title="variable">n</span></a>) (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ? ? <span class="id" title="var">HΔ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: <a class="idref" href="iris.heap_lang.array.html#wp_allocN"><span class="id" title="lemma">wp_allocN</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="../html-stdpp/stdpp.base.html#left_id"><span class="id" title="definition">left_id</span></a> <a class="idref" href="iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a>; <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="iris.bi.interface.html#bi.forall_intro"><span class="id" title="lemma">forall_intro</span></a>=&gt; <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">HΔ</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">Δ''</span>&amp;?&amp;<span class="id" title="var">HΔ'</span>). <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_app_sound"><span class="id" title="lemma">envs_app_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_intro_l"><span class="id" title="lemma">wand_intro_l</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_elim_l"><span class="id" title="lemma">sep_elim_l</span></a> (<span class="id" title="var">l</span> <a class="idref" href="iris.heap_lang.array.html#996650e7620420cf9b3213f44a2e7090"><span class="id" title="notation">↦∗</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">I</span>) <a class="idref" href="../html-stdpp/stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_elim_r"><span class="id" title="lemma">wand_elim_r</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_twp_allocN"><span class="id" title="lemma">tac_twp_allocN</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">j</span> <span class="id" title="var">K</span> <span class="id" title="var">v</span> <span class="id" title="var">n</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.ZArith.BinInt.html#143d73f5a64447681988da92e84a3de5"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <span class="id" title="var">l</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">Δ'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_app"><span class="id" title="definition">envs_app</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#j"><span class="id" title="variable">j</span></a> (<a class="idref" href="iris.heap_lang.array.html#array"><span class="id" title="definition">array</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> 1 (<a class="idref" href="../html-stdpp/stdpp.list.html#replicate"><span class="id" title="definition">replicate</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#n"><span class="id" title="variable">n</span></a>) <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a>))) <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitLoc"><span class="id" title="constructor">LitLoc</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.AllocN"><span class="id" title="constructor">AllocN</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitInt"><span class="id" title="constructor">LitInt</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#n"><span class="id" title="variable">n</span></a>) (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ? <span class="id" title="var">HΔ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: <a class="idref" href="iris.heap_lang.array.html#twp_allocN"><span class="id" title="lemma">twp_allocN</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="../html-stdpp/stdpp.base.html#left_id"><span class="id" title="definition">left_id</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.interface.html#bi.forall_intro"><span class="id" title="lemma">forall_intro</span></a>=&gt; <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">HΔ</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">Δ'</span>&amp;?&amp;<span class="id" title="var">HΔ'</span>). <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_app_sound"><span class="id" title="lemma">envs_app_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_intro_l"><span class="id" title="lemma">wand_intro_l</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_elim_l"><span class="id" title="lemma">sep_elim_l</span></a> (<span class="id" title="var">l</span> <a class="idref" href="iris.heap_lang.array.html#996650e7620420cf9b3213f44a2e7090"><span class="id" title="notation">↦∗</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">I</span>) <a class="idref" href="../html-stdpp/stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_elim_r"><span class="id" title="lemma">wand_elim_r</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_wp_alloc"><span class="id" title="lemma">tac_wp_alloc</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">Δ'</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">j</span> <span class="id" title="var">K</span> <span class="id" title="var">v</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> 1 <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <span class="id" title="var">l</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">Δ''</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_app"><span class="id" title="definition">envs_app</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#j"><span class="id" title="variable">j</span></a> (<a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a>)) <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#4f19051cc735bc20f076e5561be97384"><span class="id" title="variable">Δ''</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#4f19051cc735bc20f076e5561be97384"><span class="id" title="variable">Δ''</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.notation.html#Alloc"><span class="id" title="abbreviation">Alloc</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ? <span class="id" title="var">HΔ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: <a class="idref" href="iris.heap_lang.lifting.html#wp_alloc"><span class="id" title="lemma">wp_alloc</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="../html-stdpp/stdpp.base.html#left_id"><span class="id" title="definition">left_id</span></a> <a class="idref" href="iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a>; <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="iris.bi.interface.html#bi.forall_intro"><span class="id" title="lemma">forall_intro</span></a>=&gt; <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">HΔ</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">Δ''</span>&amp;?&amp;<span class="id" title="var">HΔ'</span>). <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_app_sound"><span class="id" title="lemma">envs_app_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_intro_l"><span class="id" title="lemma">wand_intro_l</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_elim_l"><span class="id" title="lemma">sep_elim_l</span></a> (<span class="id" title="var">l</span> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <span class="id" title="var">v</span>)%<span class="id" title="var">I</span>) <a class="idref" href="../html-stdpp/stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_elim_r"><span class="id" title="lemma">wand_elim_r</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_twp_alloc"><span class="id" title="lemma">tac_twp_alloc</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">j</span> <span class="id" title="var">K</span> <span class="id" title="var">v</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <span class="id" title="var">l</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">Δ'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_app"><span class="id" title="definition">envs_app</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#j"><span class="id" title="variable">j</span></a> (<a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a>)) <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitLoc"><span class="id" title="constructor">LitLoc</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.notation.html#Alloc"><span class="id" title="abbreviation">Alloc</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; <span class="id" title="var">HΔ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: <a class="idref" href="iris.heap_lang.lifting.html#twp_alloc"><span class="id" title="lemma">twp_alloc</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="../html-stdpp/stdpp.base.html#left_id"><span class="id" title="definition">left_id</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.interface.html#bi.forall_intro"><span class="id" title="lemma">forall_intro</span></a>=&gt; <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">HΔ</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">Δ'</span>&amp;?&amp;<span class="id" title="var">HΔ'</span>). <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_app_sound"><span class="id" title="lemma">envs_app_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_intro_l"><span class="id" title="lemma">wand_intro_l</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_elim_l"><span class="id" title="lemma">sep_elim_l</span></a> (<span class="id" title="var">l</span> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <span class="id" title="var">v</span>)%<span class="id" title="var">I</span>) <a class="idref" href="../html-stdpp/stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_elim_r"><span class="id" title="lemma">wand_elim_r</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_wp_load"><span class="id" title="lemma">tac_wp_load</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">Δ'</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">i</span> <span class="id" title="var">K</span> <span class="id" title="var">l</span> <span class="id" title="var">q</span> <span class="id" title="var">v</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> 1 <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><a class="idref" href="iris.heap_lang.proofmode.html#q"><span class="id" title="variable">q</span></a><a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Load"><span class="id" title="constructor">Load</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ???.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: <a class="idref" href="iris.heap_lang.lifting.html#wp_load"><span class="id" title="lemma">wp_load</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a> -<a class="idref" href="iris.bi.derived_laws_sbi.html#bi.later_sep"><span class="id" title="lemma">later_sep</span></a> <a class="idref" href="iris.proofmode.environments.html#envs_lookup_split"><span class="id" title="lemma">envs_lookup_split</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_twp_load"><span class="id" title="lemma">tac_twp_load</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">i</span> <span class="id" title="var">K</span> <span class="id" title="var">l</span> <span class="id" title="var">q</span> <span class="id" title="var">v</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><a class="idref" href="iris.heap_lang.proofmode.html#q"><span class="id" title="variable">q</span></a><a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Load"><span class="id" title="constructor">Load</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ??.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: <a class="idref" href="iris.heap_lang.lifting.html#twp_load"><span class="id" title="lemma">twp_load</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_lookup_split"><span class="id" title="lemma">envs_lookup_split</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_wp_store"><span class="id" title="lemma">tac_wp_store</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">Δ'</span> <span class="id" title="var">Δ''</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">i</span> <span class="id" title="var">K</span> <span class="id" title="var">l</span> <span class="id" title="var">v</span> <span class="id" title="var">v'</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> 1 <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> (<a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v'"><span class="id" title="variable">v'</span></a>)) <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#4f19051cc735bc20f076e5561be97384"><span class="id" title="variable">Δ''</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#4f19051cc735bc20f076e5561be97384"><span class="id" title="variable">Δ''</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitUnit"><span class="id" title="constructor">LitUnit</span></a>) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Store"><span class="id" title="constructor">Store</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a>) (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v'"><span class="id" title="variable">v'</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ????.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.lifting.html#wp_store"><span class="id" title="lemma">wp_store</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a> -<a class="idref" href="iris.bi.derived_laws_sbi.html#bi.later_sep"><span class="id" title="lemma">later_sep</span></a> <a class="idref" href="iris.proofmode.environments.html#envs_simple_replace_sound"><span class="id" title="lemma">envs_simple_replace_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="../html-stdpp/stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_twp_store"><span class="id" title="lemma">tac_twp_store</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">Δ'</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">i</span> <span class="id" title="var">K</span> <span class="id" title="var">l</span> <span class="id" title="var">v</span> <span class="id" title="var">v'</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> (<a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v'"><span class="id" title="variable">v'</span></a>)) <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitUnit"><span class="id" title="constructor">LitUnit</span></a>) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Store"><span class="id" title="constructor">Store</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="iris.heap_lang.proofmode.html#v'"><span class="id" title="variable">v'</span></a>) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.lifting.html#twp_store"><span class="id" title="lemma">twp_store</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_simple_replace_sound"><span class="id" title="lemma">envs_simple_replace_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="../html-stdpp/stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_wp_cmpxchg"><span class="id" title="lemma">tac_wp_cmpxchg</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">Δ'</span> <span class="id" title="var">Δ''</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">i</span> <span class="id" title="var">K</span> <span class="id" title="var">l</span> <span class="id" title="var">v</span> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> 1 <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> (<a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v2"><span class="id" title="variable">v2</span></a>)) <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#4f19051cc735bc20f076e5561be97384"><span class="id" title="variable">Δ''</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#4f19051cc735bc20f076e5561be97384"><span class="id" title="variable">Δ''</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a>) (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a>) (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v2"><span class="id" title="variable">v2</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ???? <span class="id" title="var">Hsuc</span> <span class="id" title="var">Hfail</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="../html-stdpp/stdpp.base.html#decide"><span class="id" title="definition">decide</span></a> (<span class="id" title="var">v</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">v1</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">Heq</span>|<span class="id" title="var">Hne</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.lifting.html#wp_cmpxchg_suc"><span class="id" title="lemma">wp_cmpxchg_suc</span></a>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a> -<a class="idref" href="iris.bi.derived_laws_sbi.html#bi.later_sep"><span class="id" title="lemma">later_sep</span></a> /= {1}<a class="idref" href="iris.proofmode.environments.html#envs_simple_replace_sound"><span class="id" title="lemma">envs_simple_replace_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="../html-stdpp/stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.lifting.html#wp_cmpxchg_fail"><span class="id" title="lemma">wp_cmpxchg_fail</span></a>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a> -<a class="idref" href="iris.bi.derived_laws_sbi.html#bi.later_sep"><span class="id" title="lemma">later_sep</span></a> /= {1}<a class="idref" href="iris.proofmode.environments.html#envs_lookup_split"><span class="id" title="lemma">envs_lookup_split</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_twp_cmpxchg"><span class="id" title="lemma">tac_twp_cmpxchg</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">Δ'</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">i</span> <span class="id" title="var">K</span> <span class="id" title="var">l</span> <span class="id" title="var">v</span> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> (<a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v2"><span class="id" title="variable">v2</span></a>)) <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v2"><span class="id" title="variable">v2</span></a>) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ??? <span class="id" title="var">Hsuc</span> <span class="id" title="var">Hfail</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="../html-stdpp/stdpp.base.html#decide"><span class="id" title="definition">decide</span></a> (<span class="id" title="var">v</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">v1</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">Heq</span>|<span class="id" title="var">Hne</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.lifting.html#twp_cmpxchg_suc"><span class="id" title="lemma">twp_cmpxchg_suc</span></a>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /= {1}<a class="idref" href="iris.proofmode.environments.html#envs_simple_replace_sound"><span class="id" title="lemma">envs_simple_replace_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="../html-stdpp/stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.lifting.html#twp_cmpxchg_fail"><span class="id" title="lemma">twp_cmpxchg_fail</span></a>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /= {1}<a class="idref" href="iris.proofmode.environments.html#envs_lookup_split"><span class="id" title="lemma">envs_lookup_split</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_wp_cmpxchg_fail"><span class="id" title="lemma">tac_wp_cmpxchg_fail</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">Δ'</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">i</span> <span class="id" title="var">K</span> <span class="id" title="var">l</span> <span class="id" title="var">q</span> <span class="id" title="var">v</span> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> 1 <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><a class="idref" href="iris.heap_lang.proofmode.html#q"><span class="id" title="variable">q</span></a><a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v2"><span class="id" title="variable">v2</span></a>) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ?????.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: <a class="idref" href="iris.heap_lang.lifting.html#wp_cmpxchg_fail"><span class="id" title="lemma">wp_cmpxchg_fail</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a> -<a class="idref" href="iris.bi.derived_laws_sbi.html#bi.later_sep"><span class="id" title="lemma">later_sep</span></a> <a class="idref" href="iris.proofmode.environments.html#envs_lookup_split"><span class="id" title="lemma">envs_lookup_split</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_twp_cmpxchg_fail"><span class="id" title="lemma">tac_twp_cmpxchg_fail</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">i</span> <span class="id" title="var">K</span> <span class="id" title="var">l</span> <span class="id" title="var">q</span> <span class="id" title="var">v</span> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><a class="idref" href="iris.heap_lang.proofmode.html#q"><span class="id" title="variable">q</span></a><a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v2"><span class="id" title="variable">v2</span></a>) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: <a class="idref" href="iris.heap_lang.lifting.html#twp_cmpxchg_fail"><span class="id" title="lemma">twp_cmpxchg_fail</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_lookup_split"><span class="id" title="lemma">envs_lookup_split</span></a> //=. <span class="id" title="tactic">by</span> <span class="id" title="tactic">do</span> 2 <span class="id" title="var">f_equiv</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_wp_cmpxchg_suc"><span class="id" title="lemma">tac_wp_cmpxchg_suc</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">Δ'</span> <span class="id" title="var">Δ''</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">i</span> <span class="id" title="var">K</span> <span class="id" title="var">l</span> <span class="id" title="var">v</span> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> 1 <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> (<a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v2"><span class="id" title="variable">v2</span></a>)) <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#4f19051cc735bc20f076e5561be97384"><span class="id" title="variable">Δ''</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#4f19051cc735bc20f076e5561be97384"><span class="id" title="variable">Δ''</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v2"><span class="id" title="variable">v2</span></a>) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ??????; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.lifting.html#wp_cmpxchg_suc"><span class="id" title="lemma">wp_cmpxchg_suc</span></a>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a> -<a class="idref" href="iris.bi.derived_laws_sbi.html#bi.later_sep"><span class="id" title="lemma">later_sep</span></a> <a class="idref" href="iris.proofmode.environments.html#envs_simple_replace_sound"><span class="id" title="lemma">envs_simple_replace_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="../html-stdpp/stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_twp_cmpxchg_suc"><span class="id" title="lemma">tac_twp_cmpxchg_suc</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">Δ'</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">i</span> <span class="id" title="var">K</span> <span class="id" title="var">l</span> <span class="id" title="var">v</span> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> (<a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v2"><span class="id" title="variable">v2</span></a>)) <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v"><span class="id" title="variable">v</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="iris.heap_lang.proofmode.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#v2"><span class="id" title="variable">v2</span></a>) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt;?????; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.lifting.html#twp_cmpxchg_suc"><span class="id" title="lemma">twp_cmpxchg_suc</span></a>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_simple_replace_sound"><span class="id" title="lemma">envs_simple_replace_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="../html-stdpp/stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_wp_faa"><span class="id" title="lemma">tac_wp_faa</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">Δ'</span> <span class="id" title="var">Δ''</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">i</span> <span class="id" title="var">K</span> <span class="id" title="var">l</span> <span class="id" title="var">z1</span> <span class="id" title="var">z2</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> 1 <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#z1"><span class="id" title="variable">z1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> (<a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> (<a class="idref" href="iris.heap_lang.proofmode.html#z1"><span class="id" title="variable">z1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#z2"><span class="id" title="variable">z2</span></a>))) <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#4f19051cc735bc20f076e5561be97384"><span class="id" title="variable">Δ''</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#4f19051cc735bc20f076e5561be97384"><span class="id" title="variable">Δ''</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#z1"><span class="id" title="variable">z1</span></a>) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.FAA"><span class="id" title="constructor">FAA</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a>) (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#z2"><span class="id" title="variable">z2</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ????.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: (<a class="idref" href="iris.heap_lang.lifting.html#wp_faa"><span class="id" title="lemma">wp_faa</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">z1</span> <span class="id" title="var">z2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a> -<a class="idref" href="iris.bi.derived_laws_sbi.html#bi.later_sep"><span class="id" title="lemma">later_sep</span></a> <a class="idref" href="iris.proofmode.environments.html#envs_simple_replace_sound"><span class="id" title="lemma">envs_simple_replace_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="../html-stdpp/stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="tac_twp_faa"><span class="id" title="lemma">tac_twp_faa</span></a> <span class="id" title="var">Δ</span> <span class="id" title="var">Δ'</span> <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">i</span> <span class="id" title="var">K</span> <span class="id" title="var">l</span> <span class="id" title="var">z1</span> <span class="id" title="var">z2</span> <span class="id" title="var">Φ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#z1"><span class="id" title="variable">z1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#i"><span class="id" title="variable">i</span></a> (<a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> (<a class="idref" href="iris.heap_lang.proofmode.html#z1"><span class="id" title="variable">z1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#z2"><span class="id" title="variable">z2</span></a>))) <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#e72d8b47a2a5743359baa00fb117d059"><span class="id" title="variable">Δ'</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#z1"><span class="id" title="variable">z1</span></a>) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#d44f383ce45b5283439ea630afb544d5"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#K"><span class="id" title="variable">K</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.FAA"><span class="id" title="constructor">FAA</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#l"><span class="id" title="variable">l</span></a>) (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#z2"><span class="id" title="variable">z2</span></a>)) <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="iris.heap_lang.proofmode.html#0a86c68449f31709b242a8cc62019df8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ???.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: (<a class="idref" href="iris.heap_lang.lifting.html#twp_faa"><span class="id" title="lemma">twp_faa</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">z1</span> <span class="id" title="var">z2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.proofmode.environments.html#envs_simple_replace_sound"><span class="id" title="lemma">envs_simple_replace_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="../html-stdpp/stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.bi.derived_laws_bi.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="iris.bi.derived_laws_bi.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="iris.heap_lang.proofmode.html#heap"><span class="id" title="section">heap</span></a>.<br/>

<br/>
</div>

<div class="doc">
Evaluate <span class="inlinecode"><span class="id" title="var">lem</span></span> to a hypothesis <span class="inlinecode"><a class="idref" href="iris.algebra.ofe.html#H"><span class="id" title="variable">H</span></a></span> that can be applied, and then run
<span class="inlinecode"><a class="idref" href="iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a></span> <span class="inlinecode"><a class="idref" href="iris.proofmode.class_instances_sbi.html#K"><span class="id" title="variable">K</span></a>;</span> <span class="inlinecode"><span class="id" title="var">tac</span></span> <span class="inlinecode"><a class="idref" href="iris.algebra.ofe.html#H"><span class="id" title="variable">H</span></a></span> for every possible evaluation context.  <span class="inlinecode"><span class="id" title="var">tac</span></span> can do
<span class="inlinecode"><span class="id" title="var">iApplyHyp</span></span> <span class="inlinecode"><a class="idref" href="iris.algebra.ofe.html#H"><span class="id" title="variable">H</span></a></span> to actually apply the hypothesis.  TC resolution of <span class="inlinecode"><span class="id" title="var">lem</span></span> premises
happens *after* <span class="inlinecode"><span class="id" title="var">tac</span></span> <span class="inlinecode"><a class="idref" href="iris.algebra.ofe.html#H"><span class="id" title="variable">H</span></a></span> got executed. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "wp_apply_core" <span class="id" title="var">open_constr</span>(<span class="id" title="var">lem</span>) <span class="id" title="var">tactic3</span>(<span class="id" title="var">tac</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">iPoseProofCore</span> <span class="id" title="var">lem</span> <span class="id" title="keyword">as</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind_core</span> <span class="id" title="var">K</span>; <span class="id" title="var">tac</span> <span class="id" title="var">H</span>) ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">iTypeOf</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a>?<span class="id" title="var">P</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="tactic">fail</span> "wp_apply: cannot apply" <span class="id" title="var">P</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">twp_bind_core</span> <span class="id" title="var">K</span>; <span class="id" title="var">tac</span> <span class="id" title="var">H</span>) ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">iTypeOf</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a>?<span class="id" title="var">P</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="tactic">fail</span> "wp_apply: cannot apply" <span class="id" title="var">P</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_apply: not a 'wp'"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_apply" <span class="id" title="var">open_constr</span>(<span class="id" title="var">lem</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">wp_apply_core</span> <span class="id" title="var">lem</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="var">iApplyHyp</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">iNext</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">wp_expr_simpl</span>).<br/>
</div>

<div class="doc">
Tactic tailored for atomic triples: the first, simple one just runs
<span class="inlinecode"><span class="id" title="var">iAuIntro</span></span> on the goal, as atomic triples always have an atomic update as their
premise.  The second one additionaly does some framing: it gets rid of <span class="inlinecode"><span class="id" title="var">Hs</span></span> from
the context, which is intended to be the non-laterable assertions that iAuIntro
would choke on.  You get them all back in the continuation of the atomic
operation. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "awp_apply" <span class="id" title="var">open_constr</span>(<span class="id" title="var">lem</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">wp_apply_core</span> <span class="id" title="var">lem</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="var">iApplyHyp</span> <span class="id" title="var">H</span>);<br/>
&nbsp;&nbsp;<span class="id" title="var">last</span> <span class="id" title="var">iAuIntro</span>.<br/>
<span class="id" title="keyword">Tactic Notation</span> "awp_apply" <span class="id" title="var">open_constr</span>(<span class="id" title="var">lem</span>) "without" <span class="id" title="keyword">constr</span>(<span class="id" title="var">Hs</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">wp_apply_core</span> <span class="id" title="var">lem</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="var">iApply</span> <a class="idref" href="iris.program_logic.weakestpre.html#wp_frame_wand_l"><span class="id" title="lemma">wp_frame_wand_l</span></a>; <span class="id" title="var">iSplitL</span> <span class="id" title="var">Hs</span>; [<span class="id" title="var">iAccu</span>|<span class="id" title="var">iApplyHyp</span> <span class="id" title="var">H</span>]);<br/>
&nbsp;&nbsp;<span class="id" title="var">last</span> <span class="id" title="var">iAuIntro</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_alloc" <span class="id" title="var">ident</span>(<span class="id" title="var">l</span>) "as" <span class="id" title="keyword">constr</span>(<span class="id" title="var">H</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Htmp</span> := <span class="id" title="var">iFresh</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">finish</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span> [<span class="id" title="tactic">intros</span> <span class="id" title="var">l</span> | <span class="id" title="tactic">fail</span> 1 "wp_alloc:" <span class="id" title="var">l</span> "not fresh"];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">pm_reflexivity</span> || <span class="id" title="tactic">fail</span> "wp_alloc:" <span class="id" title="var">H</span> "not fresh"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">iDestructHyp</span> <span class="id" title="var">Htmp</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H</span>; <span class="id" title="var">wp_finish</span>] <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>;<br/>
&nbsp;&nbsp;</div>

<div class="doc">
The code first tries to use allocation lemma for a single reference,
     ie, <span class="inlinecode"><a class="idref" href="iris.heap_lang.proofmode.html#tac_wp_alloc"><span class="id" title="lemma">tac_wp_alloc</span></a></span> (respectively, <span class="inlinecode"><a class="idref" href="iris.heap_lang.proofmode.html#tac_twp_alloc"><span class="id" title="lemma">tac_twp_alloc</span></a></span>).
     If that fails, it tries to use the lemma <span class="inlinecode"><a class="idref" href="iris.heap_lang.proofmode.html#tac_wp_allocN"><span class="id" title="lemma">tac_wp_allocN</span></a></span>
     (respectively, <span class="inlinecode"><a class="idref" href="iris.heap_lang.proofmode.html#tac_twp_allocN"><span class="id" title="lemma">tac_twp_allocN</span></a></span>) for allocating an array.
     Notice that we could have used the array allocation lemma also for single
     references. However, that would produce the resource l ↦∗ <span class="inlinecode"><a class="idref" href="iris.base_logic.lib.proph_map.html#v"><span class="id" title="variable">v</span></a></span> instead of
     l ↦ v for single references. These are logically equivalent assertions
     but are not equal. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">process_single</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_wp_alloc"><span class="id" title="lemma">tac_wp_alloc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Htmp</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_alloc: cannot find 'Alloc' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">finish</span> ()]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">process_array</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_wp_allocN"><span class="id" title="lemma">tac_wp_allocN</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Htmp</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_alloc: cannot find 'Alloc' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">idtac</span>|<span class="id" title="var">iSolveTC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">finish</span> ()]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> (<span class="id" title="var">process_single</span> ()) || (<span class="id" title="var">process_array</span> ())<br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">process_single</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_twp_alloc"><span class="id" title="lemma">tac_twp_alloc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Htmp</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_alloc: cannot find 'Alloc' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">finish</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">process_array</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_twp_allocN"><span class="id" title="lemma">tac_twp_allocN</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Htmp</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_alloc: cannot find 'Alloc' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">finish</span> ()]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> (<span class="id" title="var">process_single</span> ()) || (<span class="id" title="var">process_array</span> ())<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_alloc: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_alloc" <span class="id" title="var">ident</span>(<span class="id" title="var">l</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">wp_alloc</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> "?".<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_load" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">solve_mapsto</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l</span> := <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> (?<span class="id" title="var">l</span> <a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><span class="id" title="var">_</span><a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">I</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="var">l</span> <span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssumptionCore</span> || <span class="id" title="tactic">fail</span> "wp_load: cannot find" <span class="id" title="var">l</span> "↦ ?" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_wp_load"><span class="id" title="lemma">tac_wp_load</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_load: cannot find 'Load' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_twp_load"><span class="id" title="lemma">tac_twp_load</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_load: cannot find 'Load' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_load: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_store" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">solve_mapsto</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l</span> := <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> (?<span class="id" title="var">l</span> <a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><span class="id" title="var">_</span><a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">I</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="var">l</span> <span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssumptionCore</span> || <span class="id" title="tactic">fail</span> "wp_store: cannot find" <span class="id" title="var">l</span> "↦ ?" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_wp_store"><span class="id" title="lemma">tac_wp_store</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_store: cannot find 'Store' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">pm_reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">first</span> [<span class="id" title="var">wp_seq</span>|<span class="id" title="var">wp_finish</span>]]<br/>
  | |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_twp_store"><span class="id" title="lemma">tac_twp_store</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_store: cannot find 'Store' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">pm_reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">first</span> [<span class="id" title="var">wp_seq</span>|<span class="id" title="var">wp_finish</span>]]<br/>
  | <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_store: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_cmpxchg" "as" <span class="id" title="var">simple_intropattern</span>(<span class="id" title="var">H1</span>) "|" <span class="id" title="var">simple_intropattern</span>(<span class="id" title="var">H2</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">solve_mapsto</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l</span> := <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> (?<span class="id" title="var">l</span> <a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><span class="id" title="var">_</span><a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">I</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="var">l</span> <span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssumptionCore</span> || <span class="id" title="tactic">fail</span> "wp_cmpxchg: cannot find" <span class="id" title="var">l</span> "↦ ?" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_wp_cmpxchg"><span class="id" title="lemma">tac_wp_cmpxchg</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_cmpxchg: cannot find 'CmpXchg' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">pm_reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> <span class="id" title="var">solve_vals_compare_safe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">intros</span> <span class="id" title="var">H1</span>; <span class="id" title="var">wp_finish</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">intros</span> <span class="id" title="var">H2</span>; <span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_twp_cmpxchg"><span class="id" title="lemma">tac_twp_cmpxchg</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_cmpxchg: cannot find 'CmpXchg' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">pm_reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> <span class="id" title="var">solve_vals_compare_safe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">intros</span> <span class="id" title="var">H1</span>; <span class="id" title="var">wp_finish</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">intros</span> <span class="id" title="var">H2</span>; <span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_cmpxchg: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_cmpxchg_fail" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">solve_mapsto</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l</span> := <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> (?<span class="id" title="var">l</span> <a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><span class="id" title="var">_</span><a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">I</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="var">l</span> <span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssumptionCore</span> || <span class="id" title="tactic">fail</span> "wp_cmpxchg_fail: cannot find" <span class="id" title="var">l</span> "↦ ?" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_wp_cmpxchg_fail"><span class="id" title="lemma">tac_wp_cmpxchg_fail</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_cmpxchg_fail: cannot find 'CmpXchg' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> (<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">congruence</span>) <span class="comment">(*&nbsp;value&nbsp;inequality&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> <span class="id" title="var">solve_vals_compare_safe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_twp_cmpxchg_fail"><span class="id" title="lemma">tac_twp_cmpxchg_fail</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_cmpxchg_fail: cannot find 'CmpXchg' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> (<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">congruence</span>) <span class="comment">(*&nbsp;value&nbsp;inequality&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> <span class="id" title="var">solve_vals_compare_safe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_cmpxchg_fail: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_cmpxchg_suc" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">solve_mapsto</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l</span> := <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> (?<span class="id" title="var">l</span> <a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><span class="id" title="var">_</span><a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">I</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="var">l</span> <span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssumptionCore</span> || <span class="id" title="tactic">fail</span> "wp_cmpxchg_suc: cannot find" <span class="id" title="var">l</span> "↦ ?" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_wp_cmpxchg_suc"><span class="id" title="lemma">tac_wp_cmpxchg_suc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_cmpxchg_suc: cannot find 'CmpXchg' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">pm_reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> (<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">congruence</span>) <span class="comment">(*&nbsp;value&nbsp;equality&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> <span class="id" title="var">solve_vals_compare_safe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_twp_cmpxchg_suc"><span class="id" title="lemma">tac_twp_cmpxchg_suc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_cmpxchg_suc: cannot find 'CmpXchg' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">pm_reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> (<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">congruence</span>) <span class="comment">(*&nbsp;value&nbsp;equality&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> <span class="id" title="var">solve_vals_compare_safe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_cmpxchg_suc: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_faa" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">solve_mapsto</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l</span> := <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> (?<span class="id" title="var">l</span> <a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><span class="id" title="var">_</span><a class="idref" href="iris.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">I</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="var">l</span> <span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssumptionCore</span> || <span class="id" title="tactic">fail</span> "wp_faa: cannot find" <span class="id" title="var">l</span> "↦ ?" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_wp_faa"><span class="id" title="lemma">tac_wp_faa</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_faa: cannot find 'FAA' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">pm_reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| |- <a class="idref" href="iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.heap_lang.proofmode.html#tac_twp_faa"><span class="id" title="lemma">tac_twp_faa</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_faa: cannot find 'FAA' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">pm_reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_faa: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
