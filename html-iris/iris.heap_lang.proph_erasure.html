<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../overview.html">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">iris.heap_lang.proph_erasure</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.program_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="iris.program_logic.adequacy.html#"><span class="id" title="library">adequacy</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.heap_lang</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="iris.heap_lang.lang.html#"><span class="id" title="library">lang</span></a> <a class="idref" href="iris.heap_lang.notation.html#"><span class="id" title="library">notation</span></a> <a class="idref" href="iris.heap_lang.tactics.html#"><span class="id" title="library">tactics</span></a>.<br/>

<br/>
</div>

<div class="doc">
This file contains the proof that prophecies can be safely erased
from programs. We erase a program by replacing prophecy identifiers
with the unit values and respectively adapt the <span class="inlinecode"><a class="idref" href="iris.heap_lang.lang.html#heap_lang.NewProph"><span class="id" title="constructor">NewProph</span></a></span> and <span class="inlinecode"><span class="id" title="keyword">Resolve</span></span>
expressions. We prove that if a program <span class="inlinecode"><a class="idref" href="iris.bi.tactics.html#e"><span class="id" title="variable">e</span></a></span> is safe with respect to a (pure)
postcondition <span class="inlinecode">φ</span>, then program <span class="inlinecode"><span class="id" title="var">erase</span></span> <span class="inlinecode"><a class="idref" href="iris.bi.tactics.html#e"><span class="id" title="variable">e</span></a></span> is also safe with respect to <span class="inlinecode">φ</span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">e</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.expr"><span class="id" title="inductive">expr</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">l</span> : <a class="idref" href="iris.heap_lang.locations.html#loc"><span class="id" title="record">loc</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">i</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="erase_base_lit"><span class="id" title="definition">erase_base_lit</span></a> (<span class="id" title="var">l</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.base_lit"><span class="id" title="inductive">base_lit</span></a>) : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.base_lit"><span class="id" title="inductive">base_lit</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitProphecy"><span class="id" title="constructor">LitProphecy</span></a> <span class="id" title="var">p</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitPoison"><span class="id" title="constructor">LitPoison</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="erase_resolve"><span class="id" title="definition">erase_resolve</span></a> (<span class="id" title="var">e0</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.expr"><span class="id" title="inductive">expr</span></a>) : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.expr"><span class="id" title="inductive">expr</span></a> := <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Fst"><span class="id" title="constructor">Fst</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Fst"><span class="id" title="constructor">Fst</span></a> <a class="idref" href="iris.heap_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#e0"><span class="id" title="variable">e0</span></a><a class="idref" href="iris.heap_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a><a class="idref" href="iris.heap_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a><a class="idref" href="iris.heap_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="erased_new_proph"><span class="id" title="definition">erased_new_proph</span></a> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.expr"><span class="id" title="inductive">expr</span></a> := (<a class="idref" href="iris.heap_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">λ</span></a><a class="idref" href="iris.heap_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">:</span></a> <a class="idref" href="../html-stdpp/stdpp.binders.html#4ea50e8fe116b71574c09ce4628c29ae"><span class="id" title="notation">&lt;&gt;</span></a><a class="idref" href="iris.heap_lang.notation.html#704630d98f03f1fa6c74ab29b9831803"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitPoison"><span class="id" title="constructor">LitPoison</span></a>)%<span class="id" title="var">V</span> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="erase_expr"><span class="id" title="definition">erase_expr</span></a> (<span class="id" title="var">e</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.expr"><span class="id" title="inductive">expr</span></a>) : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.expr"><span class="id" title="inductive">expr</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <span class="id" title="var">v</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Var"><span class="id" title="constructor">Var</span></a> <span class="id" title="var">x</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Var"><span class="id" title="constructor">Var</span></a> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Rec"><span class="id" title="constructor">Rec</span></a> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Rec"><span class="id" title="constructor">Rec</span></a> <span class="id" title="var">f</span> <span class="id" title="var">x</span> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.App"><span class="id" title="constructor">App</span></a> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.App"><span class="id" title="constructor">App</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e2</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.UnOp"><span class="id" title="constructor">UnOp</span></a> <span class="id" title="var">op</span> <span class="id" title="var">e</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.UnOp"><span class="id" title="constructor">UnOp</span></a> <span class="id" title="var">op</span> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.BinOp"><span class="id" title="constructor">BinOp</span></a> <span class="id" title="var">op</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.BinOp"><span class="id" title="constructor">BinOp</span></a> <span class="id" title="var">op</span> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e2</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.If"><span class="id" title="constructor">If</span></a> <span class="id" title="var">e0</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.If"><span class="id" title="constructor">If</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e0</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e2</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Pair"><span class="id" title="constructor">Pair</span></a> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Pair"><span class="id" title="constructor">Pair</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e2</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Fst"><span class="id" title="constructor">Fst</span></a> <span class="id" title="var">e</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Fst"><span class="id" title="constructor">Fst</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Snd"><span class="id" title="constructor">Snd</span></a> <span class="id" title="var">e</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Snd"><span class="id" title="constructor">Snd</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.InjL"><span class="id" title="constructor">InjL</span></a> <span class="id" title="var">e</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.InjL"><span class="id" title="constructor">InjL</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.InjR"><span class="id" title="constructor">InjR</span></a> <span class="id" title="var">e</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.InjR"><span class="id" title="constructor">InjR</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Case"><span class="id" title="constructor">Case</span></a> <span class="id" title="var">e0</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Case"><span class="id" title="constructor">Case</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e0</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e2</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Fork"><span class="id" title="constructor">Fork</span></a> <span class="id" title="var">e</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Fork"><span class="id" title="constructor">Fork</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.AllocN"><span class="id" title="constructor">AllocN</span></a> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.AllocN"><span class="id" title="constructor">AllocN</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e2</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Load"><span class="id" title="constructor">Load</span></a> <span class="id" title="var">e</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Load"><span class="id" title="constructor">Load</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Store"><span class="id" title="constructor">Store</span></a> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Store"><span class="id" title="constructor">Store</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e2</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> <span class="id" title="var">e0</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e0</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e2</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FAA"><span class="id" title="constructor">FAA</span></a> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FAA"><span class="id" title="constructor">FAA</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e2</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.NewProph"><span class="id" title="constructor">NewProph</span></a> =&gt; <a class="idref" href="iris.heap_lang.proph_erasure.html#erased_new_proph"><span class="id" title="definition">erased_new_proph</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Resolve"><span class="id" title="constructor">Resolve</span></a> <span class="id" title="var">e0</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_resolve"><span class="id" title="definition">erase_resolve</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e0</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e2</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
<span class="id" title="keyword">with</span><br/>
<a name="erase_val"><span class="id" title="definition">erase_val</span></a> (<span class="id" title="var">v</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>) : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <span class="id" title="var">l</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_base_lit"><span class="id" title="definition">erase_base_lit</span></a> <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.RecV"><span class="id" title="constructor">RecV</span></a> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.RecV"><span class="id" title="constructor">RecV</span></a> <span class="id" title="var">f</span> <span class="id" title="var">x</span> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v1</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v2</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.InjLV"><span class="id" title="constructor">InjLV</span></a> <span class="id" title="var">v</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.InjLV"><span class="id" title="constructor">InjLV</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.InjRV"><span class="id" title="constructor">InjRV</span></a> <span class="id" title="var">v</span> =&gt; <a class="idref" href="iris.heap_lang.lang.html#heap_lang.InjRV"><span class="id" title="constructor">InjRV</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="erase_expr_subst"><span class="id" title="lemma">erase_expr_subst</span></a> <span class="id" title="var">x</span> <span class="id" title="var">v</span> <span class="id" title="var">e</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>)<br/>
<span class="id" title="keyword">with</span><br/>
<a name="erase_val_subst"><span class="id" title="lemma">erase_val_subst</span></a> <span class="id" title="var">x</span> <span class="id" title="var">v</span> (<span class="id" title="var">w</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#w"><span class="id" title="variable">w</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#w"><span class="id" title="variable">w</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">case_decide</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">erase_expr_subst</span> ?<span class="id" title="var">erase_val_subst</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">v</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="erase_expr_subst'"><span class="id" title="lemma">erase_expr_subst'</span></a> <span class="id" title="var">x</span> <span class="id" title="var">v</span> <span class="id" title="var">e</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.subst'"><span class="id" title="definition">subst'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.subst'"><span class="id" title="definition">subst'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr_subst"><span class="id" title="lemma">erase_expr_subst</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="erase_val_subst'"><span class="id" title="lemma">erase_val_subst'</span></a> <span class="id" title="var">x</span> <span class="id" title="var">v</span> (<span class="id" title="var">w</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#w"><span class="id" title="variable">w</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#w"><span class="id" title="variable">w</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val_subst"><span class="id" title="axiom">erase_val_subst</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="erase_ectx_item"><span class="id" title="definition">erase_ectx_item</span></a> (<span class="id" title="var">Ki</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.ectx_item"><span class="id" title="inductive">ectx_item</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.ectx_item"><span class="id" title="inductive">ectx_item</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#Ki"><span class="id" title="variable">Ki</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.AppLCtx"><span class="id" title="constructor">AppLCtx</span></a> <span class="id" title="var">v2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.AppLCtx"><span class="id" title="constructor">AppLCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v2</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.AppRCtx"><span class="id" title="constructor">AppRCtx</span></a> <span class="id" title="var">e1</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.AppRCtx"><span class="id" title="constructor">AppRCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.UnOpCtx"><span class="id" title="constructor">UnOpCtx</span></a> <span class="id" title="var">op</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.UnOpCtx"><span class="id" title="constructor">UnOpCtx</span></a> <span class="id" title="var">op</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.BinOpLCtx"><span class="id" title="constructor">BinOpLCtx</span></a> <span class="id" title="var">op</span> <span class="id" title="var">v2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.BinOpLCtx"><span class="id" title="constructor">BinOpLCtx</span></a> <span class="id" title="var">op</span> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v2</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.BinOpRCtx"><span class="id" title="constructor">BinOpRCtx</span></a> <span class="id" title="var">op</span> <span class="id" title="var">e1</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.BinOpRCtx"><span class="id" title="constructor">BinOpRCtx</span></a> <span class="id" title="var">op</span> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.IfCtx"><span class="id" title="constructor">IfCtx</span></a> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.IfCtx"><span class="id" title="constructor">IfCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e2</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairLCtx"><span class="id" title="constructor">PairLCtx</span></a> <span class="id" title="var">v2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairLCtx"><span class="id" title="constructor">PairLCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v2</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairRCtx"><span class="id" title="constructor">PairRCtx</span></a> <span class="id" title="var">e1</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairRCtx"><span class="id" title="constructor">PairRCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.SndCtx"><span class="id" title="constructor">SndCtx</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.SndCtx"><span class="id" title="constructor">SndCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.InjLCtx"><span class="id" title="constructor">InjLCtx</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.InjLCtx"><span class="id" title="constructor">InjLCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.InjRCtx"><span class="id" title="constructor">InjRCtx</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.InjRCtx"><span class="id" title="constructor">InjRCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.CaseCtx"><span class="id" title="constructor">CaseCtx</span></a> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.CaseCtx"><span class="id" title="constructor">CaseCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e2</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.AllocNLCtx"><span class="id" title="constructor">AllocNLCtx</span></a> <span class="id" title="var">v2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.AllocNLCtx"><span class="id" title="constructor">AllocNLCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v2</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.AllocNRCtx"><span class="id" title="constructor">AllocNRCtx</span></a> <span class="id" title="var">e1</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.AllocNRCtx"><span class="id" title="constructor">AllocNRCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.LoadCtx"><span class="id" title="constructor">LoadCtx</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.LoadCtx"><span class="id" title="constructor">LoadCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.StoreLCtx"><span class="id" title="constructor">StoreLCtx</span></a> <span class="id" title="var">v2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.StoreLCtx"><span class="id" title="constructor">StoreLCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v2</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.StoreRCtx"><span class="id" title="constructor">StoreRCtx</span></a> <span class="id" title="var">e1</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.StoreRCtx"><span class="id" title="constructor">StoreRCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.CmpXchgLCtx"><span class="id" title="constructor">CmpXchgLCtx</span></a> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.CmpXchgLCtx"><span class="id" title="constructor">CmpXchgLCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v1</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v2</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.CmpXchgMCtx"><span class="id" title="constructor">CmpXchgMCtx</span></a> <span class="id" title="var">e0</span> <span class="id" title="var">v2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.CmpXchgMCtx"><span class="id" title="constructor">CmpXchgMCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e0</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v2</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.CmpXchgRCtx"><span class="id" title="constructor">CmpXchgRCtx</span></a> <span class="id" title="var">e0</span> <span class="id" title="var">e1</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.CmpXchgRCtx"><span class="id" title="constructor">CmpXchgRCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e0</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FaaLCtx"><span class="id" title="constructor">FaaLCtx</span></a> <span class="id" title="var">v2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.FaaLCtx"><span class="id" title="constructor">FaaLCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v2</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FaaRCtx"><span class="id" title="constructor">FaaRCtx</span></a> <span class="id" title="var">e1</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.FaaRCtx"><span class="id" title="constructor">FaaRCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.ResolveLCtx"><span class="id" title="constructor">ResolveLCtx</span></a> <span class="id" title="var">ctx</span> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_ectx_item"><span class="id" title="definition">erase_ectx_item</span></a> <span class="id" title="var">ctx</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairLCtx"><span class="id" title="constructor">PairLCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v1</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairLCtx"><span class="id" title="constructor">PairLCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v2</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.ResolveMCtx"><span class="id" title="constructor">ResolveMCtx</span></a> <span class="id" title="var">e0</span> <span class="id" title="var">v2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairRCtx"><span class="id" title="constructor">PairRCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e0</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairLCtx"><span class="id" title="constructor">PairLCtx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v2</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.ResolveRCtx"><span class="id" title="constructor">ResolveRCtx</span></a> <span class="id" title="var">e0</span> <span class="id" title="var">e1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairRCtx"><span class="id" title="constructor">PairRCtx</span></a> <a class="idref" href="iris.heap_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e0</span><a class="idref" href="iris.heap_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e1</span><a class="idref" href="iris.heap_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="erase_ectx"><span class="id" title="definition">erase_ectx</span></a> (<span class="id" title="var">K</span> : <a class="idref" href="iris.program_logic.ectx_language.html#ectx"><span class="id" title="projection">ectx</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_ectx_lang"><span class="id" title="definition">heap_ectx_lang</span></a>) : <a class="idref" href="iris.program_logic.ectx_language.html#ectx"><span class="id" title="projection">ectx</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_ectx_lang"><span class="id" title="definition">heap_ectx_lang</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="../html-stdpp/stdpp.base.html#mbind"><span class="id" title="definition">mbind</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_ectx_item"><span class="id" title="definition">erase_ectx_item</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K"><span class="id" title="variable">K</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="erase_tp"><span class="id" title="definition">erase_tp</span></a> (<span class="id" title="var">tp</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.expr"><span class="id" title="inductive">expr</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.expr"><span class="id" title="inductive">expr</span></a> := <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#2eea06883886179dcc86cdc5a1870594"><span class="id" title="notation">&lt;$&gt;</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#tp"><span class="id" title="variable">tp</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="erase_heap"><span class="id" title="definition">erase_heap</span></a> (<span class="id" title="var">h</span> : <a class="idref" href="../html-stdpp/stdpp.gmap.html#gmap"><span class="id" title="record">gmap</span></a> <a class="idref" href="iris.heap_lang.locations.html#loc"><span class="id" title="record">loc</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>) : <a class="idref" href="../html-stdpp/stdpp.gmap.html#gmap"><span class="id" title="record">gmap</span></a> <a class="idref" href="iris.heap_lang.locations.html#loc"><span class="id" title="record">loc</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a> := <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#2eea06883886179dcc86cdc5a1870594"><span class="id" title="notation">&lt;$&gt;</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#h"><span class="id" title="variable">h</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="erase_state"><span class="id" title="definition">erase_state</span></a> (σ : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.state"><span class="id" title="record">state</span></a>) : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.state"><span class="id" title="record">state</span></a> :=<br/>
&nbsp;&nbsp;{| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">heap</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">erase_heap</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">(</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">heap</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">σ);</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">used_proph_id</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">∅</span></a> |}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="erase_cfg"><span class="id" title="definition">erase_cfg</span></a> (ρ : <a class="idref" href="iris.program_logic.language.html#cfg"><span class="id" title="definition">cfg</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang"><span class="id" title="definition">heap_lang</span></a>) : <a class="idref" href="iris.program_logic.language.html#cfg"><span class="id" title="definition">cfg</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang"><span class="id" title="definition">heap_lang</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#erase_tp"><span class="id" title="definition">erase_tp</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1af91fb19f8f622aa9ec8998986a6bf9"><span class="id" title="variable">ρ</span></a><a class="idref" href="../html-stdpp/stdpp.base.html#c018306e07f84266a36e8b4cc29a0f81"><span class="id" title="notation">.1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1af91fb19f8f622aa9ec8998986a6bf9"><span class="id" title="variable">ρ</span></a><a class="idref" href="../html-stdpp/stdpp.base.html#18385c18dcb8b3a70ec76a4d5bf90758"><span class="id" title="notation">.2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="erase_to_val"><span class="id" title="lemma">erase_to_val</span></a> <span class="id" title="var">e</span> <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.to_val"><span class="id" title="definition">to_val</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">v'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v'"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v'"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>; <span class="id" title="var">naive_solver</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="erase_not_val"><span class="id" title="lemma">erase_not_val</span></a> <span class="id" title="var">e</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.to_val"><span class="id" title="definition">to_val</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="erase_ectx_app"><span class="id" title="lemma">erase_ectx_app</span></a> <span class="id" title="var">K</span> <span class="id" title="var">K'</span> : <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_ectx"><span class="id" title="definition">erase_ectx</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#K"><span class="id" title="variable">K</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K'"><span class="id" title="variable">K'</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_ectx"><span class="id" title="definition">erase_ectx</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K"><span class="id" title="variable">K</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_ectx"><span class="id" title="definition">erase_ectx</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K'"><span class="id" title="variable">K'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_ectx"><span class="id" title="definition">erase_ectx</span></a> <a class="idref" href="../html-stdpp/stdpp.list.html#bind_app"><span class="id" title="lemma">bind_app</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="erase_ectx_expr"><span class="id" title="lemma">erase_ectx_expr</span></a> <span class="id" title="var">K</span> <span class="id" title="var">e</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K"><span class="id" title="variable">K</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_ectx"><span class="id" title="definition">erase_ectx</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K"><span class="id" title="variable">K</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">K</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">Ki</span> <span class="id" title="var">K</span> <span class="id" title="var">IHK</span>] <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">rev_ind</span></a>; <span class="id" title="var">simplify_eq</span>/=; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_ectx_app"><span class="id" title="lemma">erase_ectx_app</span></a> !<a class="idref" href="iris.program_logic.ectxi_language.html#fill_app"><span class="id" title="lemma">fill_app</span></a> /= -<span class="id" title="var">IHK</span> {<span class="id" title="var">IHK</span>}.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Ki</span>; <span class="id" title="tactic">rewrite</span> /= ?<a class="idref" href="iris.program_logic.ectxi_language.html#fill_app"><span class="id" title="lemma">fill_app</span></a> /= /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_resolve"><span class="id" title="definition">erase_resolve</span></a>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="tactic">f_equal</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="val_is_unboxed_erased"><span class="id" title="lemma">val_is_unboxed_erased</span></a> <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.val_is_unboxed"><span class="id" title="definition">val_is_unboxed</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#d9d5c539a07c7350478e89358d1fe520"><span class="id" title="notation">↔</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val_is_unboxed"><span class="id" title="definition">val_is_unboxed</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">rewrite</span> /= /<a class="idref" href="iris.heap_lang.lang.html#heap_lang.lit_is_unboxed"><span class="id" title="definition">lit_is_unboxed</span></a>; <span class="id" title="tactic">repeat</span> (<span class="id" title="var">done</span> || <span class="id" title="tactic">simpl</span>; <span class="id" title="var">case_match</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="vals_compare_safe_erase"><span class="id" title="lemma">vals_compare_safe_erase</span></a> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v1"><span class="id" title="variable">v1</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v2"><span class="id" title="variable">v2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#d9d5c539a07c7350478e89358d1fe520"><span class="id" title="notation">↔</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v2"><span class="id" title="variable">v2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> !<a class="idref" href="iris.heap_lang.proph_erasure.html#val_is_unboxed_erased"><span class="id" title="lemma">val_is_unboxed_erased</span></a>. <span class="id" title="var">done</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="erase_val_inj_iff"><span class="id" title="lemma">erase_val_inj_iff</span></a> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v2"><span class="id" title="variable">v2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v2"><span class="id" title="variable">v2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#d9d5c539a07c7350478e89358d1fe520"><span class="id" title="notation">↔</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v2"><span class="id" title="variable">v2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">v1</span>, <span class="id" title="var">v2</span>; <span class="id" title="tactic">rewrite</span> /= /<a class="idref" href="iris.heap_lang.lang.html#heap_lang.lit_is_unboxed"><span class="id" title="definition">lit_is_unboxed</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="var">done</span> || (<span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> [[] | []]) || <span class="id" title="tactic">simpl</span>; <span class="id" title="var">case_match</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
if <span class="inlinecode"><a class="idref" href="iris.heap_lang.lang.html#heap_lang.un_op_eval"><span class="id" title="definition">un_op_eval</span></a></span> succeeds on erased value,
    the so should it on the original value. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="un_op_eval_erase"><span class="id" title="lemma">un_op_eval_erase</span></a> <span class="id" title="var">op</span> <span class="id" title="var">v</span> <span class="id" title="var">v'</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.un_op_eval"><span class="id" title="definition">un_op_eval</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#op"><span class="id" title="variable">op</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v'"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#d9d5c539a07c7350478e89358d1fe520"><span class="id" title="notation">↔</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">w</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.un_op_eval"><span class="id" title="definition">un_op_eval</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#op"><span class="id" title="variable">op</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v'"><span class="id" title="variable">v'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">op</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="var">case_match</span>; <span class="id" title="var">naive_solver</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
if <span class="inlinecode"><a class="idref" href="iris.heap_lang.lang.html#heap_lang.bin_op_eval"><span class="id" title="definition">bin_op_eval</span></a></span> succeeds on erased value,
    then so should it on the original value. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="bin_op_eval_erase"><span class="id" title="lemma">bin_op_eval_erase</span></a> <span class="id" title="var">op</span> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> <span class="id" title="var">v'</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.bin_op_eval"><span class="id" title="definition">bin_op_eval</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#op"><span class="id" title="variable">op</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v1"><span class="id" title="variable">v1</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v2"><span class="id" title="variable">v2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v'"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#d9d5c539a07c7350478e89358d1fe520"><span class="id" title="notation">↔</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">w</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.bin_op_eval"><span class="id" title="definition">bin_op_eval</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#op"><span class="id" title="variable">op</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v2"><span class="id" title="variable">v2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v'"><span class="id" title="variable">v'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.lang.html#heap_lang.bin_op_eval"><span class="id" title="definition">bin_op_eval</span></a> /<a class="idref" href="iris.heap_lang.lang.html#heap_lang.bin_op_eval_int"><span class="id" title="definition">bin_op_eval_int</span></a> /<a class="idref" href="iris.heap_lang.lang.html#heap_lang.bin_op_eval_bool"><span class="id" title="definition">bin_op_eval_bool</span></a> /<a class="idref" href="iris.heap_lang.lang.html#heap_lang.bin_op_eval_loc"><span class="id" title="definition">bin_op_eval_loc</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">intros</span> ?|<span class="id" title="tactic">intros</span> (?&amp;?&amp;?)];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="var">case_match</span>; <span class="id" title="var">simplify_eq</span>/=); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <a class="idref" href="../html-stdpp/stdpp.decidable.html#bool_decide_iff"><span class="id" title="lemma">bool_decide_iff</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val_inj_iff"><span class="id" title="lemma">erase_val_inj_iff</span></a>; <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">assert</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#vals_compare_safe_erase"><span class="id" title="lemma">vals_compare_safe_erase</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="var">erewrite</span> <a class="idref" href="../html-stdpp/stdpp.decidable.html#bool_decide_iff"><span class="id" title="lemma">bool_decide_iff</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val_inj_iff"><span class="id" title="lemma">erase_val_inj_iff</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">assert</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v1</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">v2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#vals_compare_safe_erase"><span class="id" title="lemma">vals_compare_safe_erase</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="lookup_erase_heap_None"><span class="id" title="lemma">lookup_erase_heap_None</span></a> <span class="id" title="var">h</span> <span class="id" title="var">l</span> : <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap"><span class="id" title="definition">erase_heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#h"><span class="id" title="variable">h</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#d9d5c539a07c7350478e89358d1fe520"><span class="id" title="notation">↔</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#h"><span class="id" title="variable">h</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="../html-stdpp/stdpp.fin_maps.html#lookup_fmap"><span class="id" title="method">lookup_fmap</span></a>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">h</span> <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <span class="id" title="var">l</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="lookup_erase_heap"><span class="id" title="lemma">lookup_erase_heap</span></a> <span class="id" title="var">h</span> <span class="id" title="var">l</span> : <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap"><span class="id" title="definition">erase_heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#h"><span class="id" title="variable">h</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#2eea06883886179dcc86cdc5a1870594"><span class="id" title="notation">&lt;$&gt;</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#h"><span class="id" title="variable">h</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="../html-stdpp/stdpp.fin_maps.html#lookup_fmap"><span class="id" title="method">lookup_fmap</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="erase_heap_insert"><span class="id" title="lemma">erase_heap_insert</span></a> <span class="id" title="var">h</span> <span class="id" title="var">l</span> <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap"><span class="id" title="definition">erase_heap</span></a> (<a class="idref" href="../html-stdpp/stdpp.base.html#37a2c892720a610d69547926e5ba502d"><span class="id" title="notation">&lt;[</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#37a2c892720a610d69547926e5ba502d"><span class="id" title="notation">:=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="../html-stdpp/stdpp.base.html#37a2c892720a610d69547926e5ba502d"><span class="id" title="notation">]&gt;</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#h"><span class="id" title="variable">h</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#37a2c892720a610d69547926e5ba502d"><span class="id" title="notation">&lt;[</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#37a2c892720a610d69547926e5ba502d"><span class="id" title="notation">:=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="../html-stdpp/stdpp.base.html#37a2c892720a610d69547926e5ba502d"><span class="id" title="notation">]&gt;</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap"><span class="id" title="definition">erase_heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#h"><span class="id" title="variable">h</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap"><span class="id" title="definition">erase_heap</span></a> <a class="idref" href="../html-stdpp/stdpp.fin_maps.html#fmap_insert"><span class="id" title="lemma">fmap_insert</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="fmap_heap_array"><span class="id" title="lemma">fmap_heap_array</span></a> <span class="id" title="var">f</span> <span class="id" title="var">l</span> <span class="id" title="var">vs</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#2eea06883886179dcc86cdc5a1870594"><span class="id" title="notation">&lt;$&gt;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap_array"><span class="id" title="definition">heap_array</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#vs"><span class="id" title="variable">vs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap_array"><span class="id" title="definition">heap_array</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#2eea06883886179dcc86cdc5a1870594"><span class="id" title="notation">&lt;$&gt;</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#vs"><span class="id" title="variable">vs</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">l</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">vs</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">v</span> <span class="id" title="var">vs</span> <span class="id" title="var">IHvs</span>]; <span class="id" title="tactic">intros</span> <span class="id" title="var">l</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /= <a class="idref" href="../html-stdpp/stdpp.fin_maps.html#fmap_empty"><span class="id" title="lemma">fmap_empty</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /= -!<a class="idref" href="../html-stdpp/stdpp.fin_maps.html#insert_union_singleton_l"><span class="id" title="lemma">insert_union_singleton_l</span></a> !<a class="idref" href="../html-stdpp/stdpp.fin_maps.html#fmap_insert"><span class="id" title="lemma">fmap_insert</span></a> <span class="id" title="var">IHvs</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="erase_heap_array"><span class="id" title="lemma">erase_heap_array</span></a> <span class="id" title="var">l</span> <span class="id" title="var">i</span> <span class="id" title="var">v</span> <span class="id" title="var">h</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap"><span class="id" title="definition">erase_heap</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap_array"><span class="id" title="definition">heap_array</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> (<a class="idref" href="../html-stdpp/stdpp.list.html#replicate"><span class="id" title="definition">replicate</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="../html-stdpp/stdpp.base.html#e8953ae2b2281f9c2fbbd0d5d6e30fd3"><span class="id" title="notation">∪</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#h"><span class="id" title="variable">h</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap_array"><span class="id" title="definition">heap_array</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> (<a class="idref" href="../html-stdpp/stdpp.list.html#replicate"><span class="id" title="definition">replicate</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#i"><span class="id" title="variable">i</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>)) <a class="idref" href="../html-stdpp/stdpp.base.html#e8953ae2b2281f9c2fbbd0d5d6e30fd3"><span class="id" title="notation">∪</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap"><span class="id" title="definition">erase_heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#h"><span class="id" title="variable">h</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="../html-stdpp/stdpp.fin_maps.html#map_eq"><span class="id" title="method">map_eq</span></a> =&gt; <span class="id" title="var">l'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap"><span class="id" title="definition">erase_heap</span></a> <a class="idref" href="../html-stdpp/stdpp.fin_maps.html#lookup_fmap"><span class="id" title="method">lookup_fmap</span></a> !<a class="idref" href="../html-stdpp/stdpp.fin_maps.html#lookup_union"><span class="id" title="lemma">lookup_union</span></a> -<a class="idref" href="../html-stdpp/stdpp.list.html#fmap_replicate"><span class="id" title="lemma">fmap_replicate</span></a><br/>
&nbsp;&nbsp;- <a class="idref" href="iris.heap_lang.proph_erasure.html#fmap_heap_array"><span class="id" title="lemma">fmap_heap_array</span></a> !<a class="idref" href="../html-stdpp/stdpp.fin_maps.html#lookup_fmap"><span class="id" title="method">lookup_fmap</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap_array"><span class="id" title="definition">heap_array</span></a> <span class="id" title="var">l</span> (<a class="idref" href="../html-stdpp/stdpp.list.html#replicate"><span class="id" title="definition">replicate</span></a> <span class="id" title="var">i</span> <span class="id" title="var">v</span>) <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <span class="id" title="var">l'</span>); <span class="id" title="tactic">destruct</span> (<span class="id" title="var">h</span> <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <span class="id" title="var">l'</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="erase_state_init"><span class="id" title="lemma">erase_state_init</span></a> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">v</span> σ:<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.state_init_heap"><span class="id" title="definition">state_init_heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.state_init_heap"><span class="id" title="definition">state_init_heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#n"><span class="id" title="variable">n</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> /<a class="idref" href="iris.heap_lang.lang.html#heap_lang.state_init_heap"><span class="id" title="definition">state_init_heap</span></a> /= <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap_array"><span class="id" title="lemma">erase_heap_array</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="head_steps_to_erasure_of"><span class="id" title="definition">head_steps_to_erasure_of</span></a> (<span class="id" title="var">e1</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.expr"><span class="id" title="inductive">expr</span></a>) (σ1 : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.state"><span class="id" title="record">state</span></a>) (<span class="id" title="var">e2</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.expr"><span class="id" title="inductive">expr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(σ2 : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.state"><span class="id" title="record">state</span></a>) (<span class="id" title="var">efs</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.expr"><span class="id" title="inductive">expr</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">κ'</span> <span class="id" title="var">e2'</span> σ2' <span class="id" title="var">efs'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.head_step"><span class="id" title="inductive">head_step</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#6ab8901c32af191e55344d00273486a2"><span class="id" title="variable">κ'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2'"><span class="id" title="variable">e2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#502bfca0bbef2195c0a48cb6ed5249c6"><span class="id" title="variable">σ2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs'"><span class="id" title="variable">efs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2'"><span class="id" title="variable">e2'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#502bfca0bbef2195c0a48cb6ed5249c6"><span class="id" title="variable">σ2'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#a4d9266a5be6c0504292c8910a50c288"><span class="id" title="variable">σ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_tp"><span class="id" title="definition">erase_tp</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs'"><span class="id" title="variable">efs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs"><span class="id" title="variable">efs</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="erased_head_step_head_step_rec"><span class="id" title="lemma">erased_head_step_head_step_rec</span></a> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">v</span> σ :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#head_steps_to_erasure_of"><span class="id" title="definition">head_steps_to_erasure_of</span></a> ((<a class="idref" href="iris.heap_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">rec</span></a><a class="idref" href="iris.heap_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">:</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="iris.heap_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">:=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>)%<span class="id" title="var">V</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="iris.heap_lang.lang.html#heap_lang.subst'"><span class="id" title="definition">subst'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="iris.heap_lang.lang.html#heap_lang.subst'"><span class="id" title="definition">subst'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#f"><span class="id" title="variable">f</span></a> (<a class="idref" href="iris.heap_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">rec</span></a><a class="idref" href="iris.heap_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">:</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="iris.heap_lang.notation.html#3b4611ead68c65413f980c1d4a390696"><span class="id" title="notation">:=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">rewrite</span> !<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr_subst'"><span class="id" title="lemma">erase_expr_subst'</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="erased_head_step_head_step_NewProph"><span class="id" title="lemma">erased_head_step_head_step_NewProph</span></a> σ :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#head_steps_to_erasure_of"><span class="id" title="definition">head_steps_to_erasure_of</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.NewProph"><span class="id" title="constructor">NewProph</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitPoison"><span class="id" title="constructor">LitPoison</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.new_proph_id_fresh"><span class="id" title="lemma">new_proph_id_fresh</span></a>; <span class="id" title="var">done</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="erased_head_step_head_step_AllocN"><span class="id" title="lemma">erased_head_step_head_step_AllocN</span></a> <span class="id" title="var">n</span> <span class="id" title="var">v</span> σ <span class="id" title="var">l</span> :<br/>
&nbsp;&nbsp;0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.ZArith.BinInt.html#143d73f5a64447681988da92e84a3de5"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <span class="id" title="var">i</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> 0 <a class="idref" href="../html-stdpp/stdpp.numbers.html#4ba61b06dfba8efe2fde3e31f9b023d3"><span class="id" title="notation">≤</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.ZArith.BinInt.html#143d73f5a64447681988da92e84a3de5"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap"><span class="id" title="definition">erase_heap</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap"><span class="id" title="projection">heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">(</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.locations.html#bc1cab6cf9386d7d54258da29afab04c"><span class="id" title="notation">+ₗ</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#i"><span class="id" title="variable">i</span></a><a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#head_steps_to_erasure_of"><span class="id" title="definition">head_steps_to_erasure_of</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="iris.heap_lang.lang.html#heap_lang.AllocN"><span class="id" title="constructor">AllocN</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.state_init_heap"><span class="id" title="definition">state_init_heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#n"><span class="id" title="variable">n</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span> <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">setoid_rewrite</span> &lt;- <a class="idref" href="iris.heap_lang.proph_erasure.html#lookup_erase_heap_None"><span class="id" title="lemma">lookup_erase_heap_None</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap_insert"><span class="id" title="lemma">erase_heap_insert</span></a> /=; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state_init"><span class="id" title="lemma">erase_state_init</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="erased_head_step_head_step_Load"><span class="id" title="lemma">erased_head_step_head_step_Load</span></a> <span class="id" title="var">l</span> σ <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap"><span class="id" title="definition">erase_heap</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap"><span class="id" title="projection">heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#head_steps_to_erasure_of"><span class="id" title="definition">head_steps_to_erasure_of</span></a> (<a class="idref" href="iris.heap_lang.notation.html#569b74bc432a2b233b93ae1b45418e26"><span class="id" title="notation">!</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#lookup_erase_heap"><span class="id" title="lemma">lookup_erase_heap</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap"><span class="id" title="projection">heap</span></a> σ <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="erased_head_step_head_step_Store"><span class="id" title="lemma">erased_head_step_head_step_Store</span></a> <span class="id" title="var">l</span> <span class="id" title="var">v</span> σ :<br/>
&nbsp;&nbsp;<a class="idref" href="../html-stdpp/stdpp.option.html#is_Some"><span class="id" title="definition">is_Some</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap"><span class="id" title="definition">erase_heap</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap"><span class="id" title="projection">heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#head_steps_to_erasure_of"><span class="id" title="definition">head_steps_to_erasure_of</span></a> (<a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.notation.html#c86a93f3678d40e29f281dd490cfc181"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.notation.html#3127c6bc552ca21a494fc6e3474a507d"><span class="id" title="notation">()</span></a><br/>
&nbsp;&nbsp;&nbsp;{| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">heap</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">&lt;[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">l</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">:=</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">erase_val</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">v</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">]&gt;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">(</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">erase_heap</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">(</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">heap</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">σ));</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">used_proph_id</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">∅</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#lookup_erase_heap"><span class="id" title="lemma">lookup_erase_heap</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap"><span class="id" title="projection">heap</span></a> σ <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:?; <span class="id" title="var">simplify_eq</span>/=;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="../html-stdpp/stdpp.option.html#is_Some_None"><span class="id" title="lemma">is_Some_None</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.lang.html#heap_lang.state_upd_heap"><span class="id" title="definition">state_upd_heap</span></a> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> /= <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap_insert"><span class="id" title="lemma">erase_heap_insert</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="erased_head_step_head_step_CmpXchg"><span class="id" title="lemma">erased_head_step_head_step_CmpXchg</span></a> <span class="id" title="var">l</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> σ <span class="id" title="var">vl</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap"><span class="id" title="definition">erase_heap</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap"><span class="id" title="projection">heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#vl"><span class="id" title="variable">vl</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#vl"><span class="id" title="variable">vl</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#head_steps_to_erasure_of"><span class="id" title="definition">head_steps_to_erasure_of</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="iris.heap_lang.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#w"><span class="id" title="variable">w</span></a>) <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.notation.html#cc14470b8443804ba405fa710525256d"><span class="id" title="notation">(</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#vl"><span class="id" title="variable">vl</span></a><a class="idref" href="iris.heap_lang.notation.html#cc14470b8443804ba405fa710525256d"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#(</span></a><a class="idref" href="../html-stdpp/stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#vl"><span class="id" title="variable">vl</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>)<a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">)</span></a><a class="idref" href="iris.heap_lang.notation.html#cc14470b8443804ba405fa710525256d"><span class="id" title="notation">)</span></a>%<span class="id" title="var">V</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.ssr.ssreflect.html#201058f4aa915cdea9258bc97aa9ee97"><span class="id" title="notation">if</span></a> <a class="idref" href="../html-stdpp/stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#vl"><span class="id" title="variable">vl</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.ssr.ssreflect.html#201058f4aa915cdea9258bc97aa9ee97"><span class="id" title="notation">then</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.ssr.ssreflect.html#201058f4aa915cdea9258bc97aa9ee97"><span class="id" title="notation">{|</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">heap</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">&lt;[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">l</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">:=</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">erase_val</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">w</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">]&gt;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">(</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">erase_heap</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">(</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">heap</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">σ));</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">used_proph_id</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">∅</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.ssr.ssreflect.html#201058f4aa915cdea9258bc97aa9ee97"><span class="id" title="notation">|}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.ssr.ssreflect.html#201058f4aa915cdea9258bc97aa9ee97"><span class="id" title="notation">else</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hl</span> <span class="id" title="var">Hvl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#lookup_erase_heap"><span class="id" title="lemma">lookup_erase_heap</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap"><span class="id" title="projection">heap</span></a> σ <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <span class="id" title="var">l</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">u</span>|] <span class="id" title="var">eqn</span>:?; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -&gt; <a class="idref" href="iris.heap_lang.proph_erasure.html#vals_compare_safe_erase"><span class="id" title="lemma">vals_compare_safe_erase</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="../html-stdpp/stdpp.base.html#decide"><span class="id" title="definition">decide</span></a> (<span class="id" title="var">u</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">v</span>)) <span class="id" title="keyword">as</span> [-&gt;|<span class="id" title="var">Hneq</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="../html-stdpp/stdpp.decidable.html#bool_decide_eq_true_2"><span class="id" title="lemma">bool_decide_eq_true_2</span></a>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val_inj_iff"><span class="id" title="lemma">erase_val_inj_iff</span></a>; [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -?<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap_insert"><span class="id" title="lemma">erase_heap_insert</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">split_and</span>!; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="../html-stdpp/stdpp.decidable.html#bool_decide_eq_false_2"><span class="id" title="lemma">bool_decide_eq_false_2</span></a>; <span class="id" title="tactic">eauto</span>; [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val_inj_iff"><span class="id" title="lemma">erase_val_inj_iff</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a name="erased_head_step_head_step_FAA"><span class="id" title="lemma">erased_head_step_head_step_FAA</span></a> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> σ :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap"><span class="id" title="definition">erase_heap</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap"><span class="id" title="projection">heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#head_steps_to_erasure_of"><span class="id" title="definition">head_steps_to_erasure_of</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="iris.heap_lang.lang.html#heap_lang.FAA"><span class="id" title="constructor">FAA</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#m"><span class="id" title="variable">m</span></a>) <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#n"><span class="id" title="variable">n</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{| <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">heap</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">&lt;[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">l</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">#(</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">n</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">+</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">m</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">)]&gt;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">(</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">erase_heap</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">(</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">heap</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">σ));</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">used_proph_id</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Build_state"><span class="id" title="constructor">∅</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#lookup_erase_heap"><span class="id" title="lemma">lookup_erase_heap</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap"><span class="id" title="projection">heap</span></a> σ <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <span class="id" title="var">l</span>) <span class="id" title="keyword">as</span> [[[]| | | |]|] <span class="id" title="var">eqn</span>:?; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.lang.html#heap_lang.state_upd_heap"><span class="id" title="definition">state_upd_heap</span></a> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> /= <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_heap_insert"><span class="id" title="lemma">erase_heap_insert</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
When the erased program makes a head step, so does the original program. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="erased_head_step_head_step"><span class="id" title="lemma">erased_head_step_head_step</span></a> <span class="id" title="var">e1</span> σ1 <span class="id" title="var">κ</span> <span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.head_step"><span class="id" title="inductive">head_step</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a>) <a class="idref" href="iris.heap_lang.proph_erasure.html#29d7d9bf2d713ce949c9fed315ed8ffb"><span class="id" title="variable">κ</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#a4d9266a5be6c0504292c8910a50c288"><span class="id" title="variable">σ2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#head_steps_to_erasure_of"><span class="id" title="definition">head_steps_to_erasure_of</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#a4d9266a5be6c0504292c8910a50c288"><span class="id" title="variable">σ2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs"><span class="id" title="variable">efs</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hhstep</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hhstep</span>; <span class="id" title="var">simplify_eq</span>/=;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> ?<span class="id" title="var">e</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>; <span class="id" title="var">simplify_eq</span>/=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> ?<span class="id" title="var">v</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">v</span>; <span class="id" title="var">simplify_eq</span>/=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_base_lit"><span class="id" title="definition">erase_base_lit</span></a> ?<span class="id" title="var">l</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>; <span class="id" title="var">simplify_eq</span>/=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="keyword">context</span> [<a class="idref" href="iris.heap_lang.proph_erasure.html#erased_new_proph"><span class="id" title="definition">erased_new_proph</span></a>] |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#erased_new_proph"><span class="id" title="definition">erased_new_proph</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.un_op_eval"><span class="id" title="definition">un_op_eval</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">_</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#un_op_eval_erase"><span class="id" title="lemma">un_op_eval_erase</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [? [? ?]]<br/>
           | <span class="id" title="var">H</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.bin_op_eval"><span class="id" title="definition">bin_op_eval</span></a> <span class="id" title="var">_</span> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">_</span>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <span class="id" title="var">_</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#bin_op_eval_erase"><span class="id" title="lemma">bin_op_eval_erase</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [? [? ?]]<br/>
           <span class="id" title="keyword">end</span>; <span class="id" title="var">simplify_eq</span>/=;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">by</span> <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">econstructor</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#erased_head_step_head_step_rec"><span class="id" title="lemma">erased_head_step_head_step_rec</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erased_head_step_head_step_NewProph"><span class="id" title="lemma">erased_head_step_head_step_NewProph</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erased_head_step_head_step_AllocN"><span class="id" title="lemma">erased_head_step_head_step_AllocN</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erased_head_step_head_step_Load"><span class="id" title="lemma">erased_head_step_head_step_Load</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erased_head_step_head_step_Store"><span class="id" title="lemma">erased_head_step_head_step_Store</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erased_head_step_head_step_CmpXchg"><span class="id" title="lemma">erased_head_step_head_step_CmpXchg</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erased_head_step_head_step_FAA"><span class="id" title="lemma">erased_head_step_head_step_FAA</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="fill_to_resolve"><span class="id" title="lemma">fill_to_resolve</span></a> <span class="id" title="var">e</span> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e'"><span class="id" title="variable">e'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Resolve"><span class="id" title="constructor">Resolve</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v2"><span class="id" title="variable">v2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K"><span class="id" title="variable">K</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e'"><span class="id" title="variable">e'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#K"><span class="id" title="variable">K</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#9b27a55e56b4bfcc20e5b8cbd0156a3e"><span class="id" title="notation">∨</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">K'</span> <span class="id" title="var">Ki</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K"><span class="id" title="variable">K</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K'"><span class="id" title="variable">K'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.ResolveLCtx"><span class="id" title="constructor">ResolveLCtx</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#Ki"><span class="id" title="variable">Ki</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v2"><span class="id" title="variable">v2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hnv</span> <span class="id" title="var">Hrs</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <span class="id" title="var">v</span> <span class="id" title="var">K</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K"><span class="id" title="variable">K</span></a> <span class="id" title="var">e'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hcontr</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">w</span> <span class="id" title="var">K'</span> <span class="id" title="var">Hw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.to_val"><span class="id" title="definition">to_val</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.of_val"><span class="id" title="abbreviation">of_val</span></a> <span class="id" title="var">w</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.to_val"><span class="id" title="definition">to_val</span></a> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K'</span> <span class="id" title="var">e'</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">He'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hw</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.program_logic.ectxi_language.html#fill_not_val"><span class="id" title="lemma">fill_not_val</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">He'</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">K</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">Ki</span> <span class="id" title="var">K</span> <span class="id" title="var">_</span>] <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">rev_ind</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.program_logic.ectxi_language.html#fill_app"><span class="id" title="lemma">fill_app</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hrs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Ki</span>; <span class="id" title="var">simplify_eq</span>/=; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">exfalso</span>; <span class="id" title="tactic">eapply</span> <span class="id" title="var">Hcontr</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="projs_pure_steps"><span class="id" title="lemma">projs_pure_steps</span></a> (<span class="id" title="var">v0</span> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="../html-stdpp/stdpp.relations.html#rtc"><span class="id" title="inductive">rtc</span></a> <a class="idref" href="iris.program_logic.language.html#pure_step"><span class="id" title="record">pure_step</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Fst"><span class="id" title="constructor">Fst</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Fst"><span class="id" title="constructor">Fst</span></a> <a class="idref" href="iris.heap_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">(</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#v0"><span class="id" title="variable">v0</span></a><a class="idref" href="iris.heap_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v1"><span class="id" title="variable">v1</span></a><a class="idref" href="iris.heap_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v2"><span class="id" title="variable">v2</span></a><a class="idref" href="iris.heap_lang.notation.html#ec04ba08aeb86de76ca579a7aa123c03"><span class="id" title="notation">)</span></a>)) <a class="idref" href="iris.heap_lang.proph_erasure.html#v0"><span class="id" title="variable">v0</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">etrans</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="iris.program_logic.language.html#rtc_pure_step_ctx"><span class="id" title="lemma">rtc_pure_step_ctx</span></a> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairLCtx"><span class="id" title="constructor">PairLCtx</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>)).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="../html-stdpp/stdpp.relations.html#rtc_once"><span class="id" title="lemma">rtc_once</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#pure_head_step_pure_step"><span class="id" title="lemma">pure_head_step_pure_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ????? <span class="id" title="var">Hhstep</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hhstep</span>; <span class="id" title="var">simplify_eq</span>/=; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">etrans</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="iris.program_logic.language.html#rtc_pure_step_ctx"><span class="id" title="lemma">rtc_pure_step_ctx</span></a> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>)).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="../html-stdpp/stdpp.relations.html#rtc_once"><span class="id" title="lemma">rtc_once</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#pure_head_step_pure_step"><span class="id" title="lemma">pure_head_step_pure_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ????? <span class="id" title="var">Hhstep</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hhstep</span>; <span class="id" title="var">simplify_eq</span>/=; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">etrans</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="iris.program_logic.language.html#rtc_pure_step_ctx"><span class="id" title="lemma">rtc_pure_step_ctx</span></a> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>)).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="../html-stdpp/stdpp.relations.html#rtc_once"><span class="id" title="lemma">rtc_once</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#pure_head_step_pure_step"><span class="id" title="lemma">pure_head_step_pure_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ????? <span class="id" title="var">Hhstep</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hhstep</span>; <span class="id" title="var">simplify_eq</span>/=; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="../html-stdpp/stdpp.relations.html#rtc_once"><span class="id" title="lemma">rtc_once</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#pure_head_step_pure_step"><span class="id" title="lemma">pure_head_step_pure_step</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ????? <span class="id" title="var">Hhstep</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hhstep</span>; <span class="id" title="var">simplify_eq</span>/=; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="Resolve_3_vals_head_stuck"><span class="id" title="lemma">Resolve_3_vals_head_stuck</span></a> <span class="id" title="var">v0</span> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> σ <span class="id" title="var">κ</span> <span class="id" title="var">e</span> σ' <span class="id" title="var">efs</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#b02645851bc60f28087c4c8d90376442"><span class="id" title="notation">¬</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.head_step"><span class="id" title="inductive">head_step</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Resolve"><span class="id" title="constructor">Resolve</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v0"><span class="id" title="variable">v0</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v2"><span class="id" title="variable">v2</span></a>) <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#29d7d9bf2d713ce949c9fed315ed8ffb"><span class="id" title="variable">κ</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#4394a2ef16b8915a5209b8b27258ea45"><span class="id" title="variable">σ'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs"><span class="id" title="variable">efs</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hhstep</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hhstep</span>; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="../html-stdpp/stdpp.option.html#eq_None_not_Some"><span class="id" title="lemma">eq_None_not_Some</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.to_val"><span class="id" title="definition">to_val</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <span class="id" title="var">v0</span>))); <span class="id" title="var">last</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val_head_stuck"><span class="id" title="lemma">val_head_stuck</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="Resolve_3_vals_unsafe"><span class="id" title="lemma">Resolve_3_vals_unsafe</span></a> (<span class="id" title="var">v0</span> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>) σ :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#b02645851bc60f28087c4c8d90376442"><span class="id" title="notation">¬</span></a> <a class="idref" href="iris.program_logic.language.html#not_stuck"><span class="id" title="definition">not_stuck</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Resolve"><span class="id" title="constructor">Resolve</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v0"><span class="id" title="variable">v0</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v2"><span class="id" title="variable">v2</span></a>) <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span>(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <span class="id" title="var">w</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K"><span class="id" title="variable">K</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="../html-stdpp/stdpp.option.html#is_Some"><span class="id" title="definition">is_Some</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Hvfill</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? <span class="id" title="var">K</span> ? <span class="id" title="var">Heq</span>; <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.program_logic.ectx_language.html#fill_val"><span class="id" title="lemma">fill_val</span></a> <span class="id" title="var">K</span>); <span class="id" title="tactic">rewrite</span> /= -<span class="id" title="var">Heq</span>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.language.html#not_not_stuck"><span class="id" title="lemma">not_not_stuck</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ???? [<span class="id" title="var">K</span> <span class="id" title="var">e1'</span> <span class="id" title="var">e2'</span> <span class="id" title="var">Hrs</span> <span class="id" title="var">Hhstep</span>]; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">K</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">Ki</span> <span class="id" title="var">K</span> <span class="id" title="var">_</span>] <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">rev_ind</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#Resolve_3_vals_head_stuck"><span class="id" title="lemma">Resolve_3_vals_head_stuck</span></a>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.program_logic.ectxi_language.html#fill_app"><span class="id" title="lemma">fill_app</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hrs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Ki</span>; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.fill_item_val"><span class="id" title="lemma">fill_item_val</span></a> <span class="id" title="var">Ki</span> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span> <span class="id" title="var">e1'</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Hnv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#fill_val"><span class="id" title="lemma">fill_val</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hnv</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">Hnv</span>]; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> -<span class="id" title="var">Hrs</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">erewrite</span> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val_head_stuck"><span class="id" title="lemma">val_head_stuck</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hnv</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">edestruct</span> <span class="id" title="var">Hvfill</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">Heq</span>]; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">erewrite</span> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val_head_stuck"><span class="id" title="lemma">val_head_stuck</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">edestruct</span> <span class="id" title="var">Hvfill</span> <span class="id" title="keyword">as</span> [? <span class="id" title="var">Heq</span>]; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">erewrite</span> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val_head_stuck"><span class="id" title="lemma">val_head_stuck</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">(<a class="idref" href="iris.bi.tactics.html#e1"><span class="id" title="variable">e1</span></a>,</span> <span class="inlinecode">σ1)</span> takes a <span class="inlinecode"><a class="idref" href="iris.program_logic.ectx_language.html#prim_step"><span class="id" title="inductive">prim_step</span></a></span> to <span class="inlinecode">(<a class="idref" href="iris.bi.tactics.html#e2'"><span class="id" title="variable">e2'</span></a>,</span> <span class="inlinecode">σ2')</span> forking threads <span class="inlinecode"><a class="idref" href="iris.heap_lang.proph_erasure.html#efs'"><span class="id" title="variable">efs'</span></a></span>
 such that <span class="inlinecode">σ2</span> is the erasure of <span class="inlinecode">σ2'</span> and <span class="inlinecode"><a class="idref" href="iris.heap_lang.lifting.html#efs"><span class="id" title="variable">efs</span></a></span> is the erasure of
 <span class="inlinecode"><a class="idref" href="iris.heap_lang.proph_erasure.html#efs'"><span class="id" title="variable">efs'</span></a></span>. Furthermore, <span class="inlinecode"><a class="idref" href="iris.bi.tactics.html#e2"><span class="id" title="variable">e2</span></a></span> takes <span class="inlinecode"><span class="id" title="var">pure_steps</span></span> to match up with <span class="inlinecode"><a class="idref" href="iris.bi.tactics.html#e2"><span class="id" title="variable">e2</span></a></span>.  It is
 crucial for us that <span class="inlinecode"><a class="idref" href="iris.bi.tactics.html#e2"><span class="id" title="variable">e2</span></a></span> takes <span class="inlinecode"><a class="idref" href="iris.program_logic.language.html#pure_step"><span class="id" title="record">pure_step</span></a></span>s because we need to know
 that <span class="inlinecode"><a class="idref" href="iris.bi.tactics.html#e2"><span class="id" title="variable">e2</span></a></span> does not get stuck and that the steps are deterministic.

<div class="paragraph"> </div>

 Essentially, the main part of the erasure proof's argument is that if
 the erased program takes steps, then the original program also takes
 matching steps. This however, does not entirely hold. In cases where
 the erasure of <span class="inlinecode"><span class="id" title="var">Resovle</span></span> takes a step, the original program
 immediately produces the value while the erased program has to still
 perform projections <span class="inlinecode"><a class="idref" href="iris.heap_lang.lang.html#heap_lang.Fst"><span class="id" title="constructor">Fst</span></a></span> to get the result (see the <span class="inlinecode"><span class="id" title="keyword">Resolve</span></span> case
 of <span class="inlinecode"><a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a></span>). For this purpose, we prove that in those cases (and
 also in general) the erased program also takes a number of (possibly
 zero) steps so that the original and the erased programs are matched
 up again. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a name="prim_step_matched_by_erased_steps"><span class="id" title="definition">prim_step_matched_by_erased_steps</span></a> <span class="id" title="var">e1</span> σ1 <span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">e2'</span> σ2' <span class="id" title="var">κ'</span> <span class="id" title="var">efs'</span> <span class="id" title="var">e2''</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.program_logic.ectx_language.html#prim_step"><span class="id" title="inductive">prim_step</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#6ab8901c32af191e55344d00273486a2"><span class="id" title="variable">κ'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2'"><span class="id" title="variable">e2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#502bfca0bbef2195c0a48cb6ed5249c6"><span class="id" title="variable">σ2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs'"><span class="id" title="variable">efs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="../html-stdpp/stdpp.relations.html#rtc"><span class="id" title="inductive">rtc</span></a> <a class="idref" href="iris.program_logic.language.html#pure_step"><span class="id" title="record">pure_step</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2''"><span class="id" title="variable">e2''</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2'"><span class="id" title="variable">e2'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2''"><span class="id" title="variable">e2''</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#502bfca0bbef2195c0a48cb6ed5249c6"><span class="id" title="variable">σ2'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#a4d9266a5be6c0504292c8910a50c288"><span class="id" title="variable">σ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_tp"><span class="id" title="definition">erase_tp</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs'"><span class="id" title="variable">efs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs"><span class="id" title="variable">efs</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="prim_step_matched_by_erased_steps_ectx"><span class="id" title="lemma">prim_step_matched_by_erased_steps_ectx</span></a> <span class="id" title="var">K</span> <span class="id" title="var">e1</span> σ1 <span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#prim_step_matched_by_erased_steps"><span class="id" title="definition">prim_step_matched_by_erased_steps</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#a4d9266a5be6c0504292c8910a50c288"><span class="id" title="variable">σ2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#prim_step_matched_by_erased_steps"><span class="id" title="definition">prim_step_matched_by_erased_steps</span></a> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K"><span class="id" title="variable">K</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a>) <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_ectx"><span class="id" title="definition">erase_ectx</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K"><span class="id" title="variable">K</span></a>) <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a>) <a class="idref" href="iris.heap_lang.proph_erasure.html#a4d9266a5be6c0504292c8910a50c288"><span class="id" title="variable">σ2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs"><span class="id" title="variable">efs</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?); <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#fill_prim_step"><span class="id" title="lemma">fill_prim_step</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_ectx_expr"><span class="id" title="lemma">erase_ectx_expr</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.program_logic.language.html#rtc_pure_step_ctx"><span class="id" title="lemma">rtc_pure_step_ctx</span></a> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_ectx"><span class="id" title="definition">erase_ectx</span></a> <span class="id" title="var">K</span>))).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="is_Resolve"><span class="id" title="definition">is_Resolve</span></a> (<span class="id" title="var">e</span> : <a class="idref" href="iris.heap_lang.lang.html#heap_lang.expr"><span class="id" title="inductive">expr</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="keyword">with</span> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.Resolve"><span class="id" title="constructor">Resolve</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="../html-stdpp/stdpp.base.html#e2da2dc5adb39aa5394d64f0045c62a4"><span class="id" title="notation">True</span></a> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="../html-stdpp/stdpp.base.html#c355ddcd7bc517c0d78bdc33e3c6747d"><span class="id" title="notation">False</span></a> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a name="is_Resolve_dec"><span class="id" title="instance">is_Resolve_dec</span></a> <span class="id" title="var">e</span> : <a class="idref" href="../html-stdpp/stdpp.base.html#Decision"><span class="id" title="class">Decision</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#is_Resolve"><span class="id" title="definition">is_Resolve</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>; <span class="id" title="var">solve_decision</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="non_resolve_prim_step_matched_by_erased_steps_ectx_item"><span class="id" title="lemma">non_resolve_prim_step_matched_by_erased_steps_ectx_item</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ki</span> <span class="id" title="var">e1</span> <span class="id" title="var">e1'</span> σ1 <span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1'"><span class="id" title="variable">e1'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#b02645851bc60f28087c4c8d90376442"><span class="id" title="notation">¬</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#is_Resolve"><span class="id" title="definition">is_Resolve</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.program_logic.language.html#not_stuck"><span class="id" title="definition">not_stuck</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.fill_item"><span class="id" title="definition">fill_item</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#Ki"><span class="id" title="variable">Ki</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1'"><span class="id" title="variable">e1'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <span class="id" title="var">e1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1'"><span class="id" title="variable">e1'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.program_logic.language.html#not_stuck"><span class="id" title="definition">not_stuck</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#prim_step_matched_by_erased_steps"><span class="id" title="definition">prim_step_matched_by_erased_steps</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#a4d9266a5be6c0504292c8910a50c288"><span class="id" title="variable">σ2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs"><span class="id" title="variable">efs</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#prim_step_matched_by_erased_steps"><span class="id" title="definition">prim_step_matched_by_erased_steps</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.fill_item"><span class="id" title="definition">fill_item</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#Ki"><span class="id" title="variable">Ki</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a>) <a class="idref" href="iris.heap_lang.proph_erasure.html#a4d9266a5be6c0504292c8910a50c288"><span class="id" title="variable">σ2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs"><span class="id" title="variable">efs</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hnv</span> <span class="id" title="var">Hnr</span> <span class="id" title="var">Hsf</span> <span class="id" title="var">He1</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Ki</span>; <span class="id" title="var">simplify_eq</span>/=;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> ?<span class="id" title="var">e</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>; <span class="id" title="var">simplify_eq</span>/=; <span class="id" title="tactic">try</span> <span class="id" title="var">done</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="keyword">context</span> [<a class="idref" href="iris.heap_lang.proph_erasure.html#erased_new_proph"><span class="id" title="definition">erased_new_proph</span></a>] |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erased_new_proph"><span class="id" title="definition">erased_new_proph</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="var">simplify_eq</span>/=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="iris.heap_lang.proph_erasure.html#prim_step_matched_by_erased_steps"><span class="id" title="definition">prim_step_matched_by_erased_steps</span></a> ?<span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">tac</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">K</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> (<a class="idref" href="iris.heap_lang.proph_erasure.html#prim_step_matched_by_erased_steps_ectx"><span class="id" title="lemma">prim_step_matched_by_erased_steps_ectx</span></a> <span class="id" title="var">K</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [<span class="id" title="var">done</span>| <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.program_logic.language.html#not_stuck_fill_inv"><span class="id" title="lemma">not_stuck_fill_inv</span></a> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">K</span>))]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="var">tac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="prim_step_matched_by_erased_steps_ectx_item"><span class="id" title="lemma">prim_step_matched_by_erased_steps_ectx_item</span></a> <span class="id" title="var">Ki</span> <span class="id" title="var">K</span> <span class="id" title="var">e1</span> <span class="id" title="var">e1'</span> σ1 <span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span> <span class="id" title="var">κ</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.head_step"><span class="id" title="inductive">head_step</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1'"><span class="id" title="variable">e1'</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a>) <a class="idref" href="iris.heap_lang.proph_erasure.html#29d7d9bf2d713ce949c9fed315ed8ffb"><span class="id" title="variable">κ</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#a4d9266a5be6c0504292c8910a50c288"><span class="id" title="variable">σ2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.program_logic.language.html#not_stuck"><span class="id" title="definition">not_stuck</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.fill_item"><span class="id" title="definition">fill_item</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#Ki"><span class="id" title="variable">Ki</span></a> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K"><span class="id" title="variable">K</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1'"><span class="id" title="variable">e1'</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <span class="id" title="var">K'</span> <span class="id" title="var">e1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K'"><span class="id" title="variable">K'</span></a> <a class="idref" href="../html-stdpp/stdpp.numbers.html#4ba61b06dfba8efe2fde3e31f9b023d3"><span class="id" title="notation">≤</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K"><span class="id" title="variable">K</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K'"><span class="id" title="variable">K'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1'"><span class="id" title="variable">e1'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.program_logic.language.html#not_stuck"><span class="id" title="definition">not_stuck</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#prim_step_matched_by_erased_steps"><span class="id" title="definition">prim_step_matched_by_erased_steps</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K'"><span class="id" title="variable">K'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a>) <a class="idref" href="iris.heap_lang.proph_erasure.html#a4d9266a5be6c0504292c8910a50c288"><span class="id" title="variable">σ2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs"><span class="id" title="variable">efs</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#prim_step_matched_by_erased_steps"><span class="id" title="definition">prim_step_matched_by_erased_steps</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.fill_item"><span class="id" title="definition">fill_item</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#Ki"><span class="id" title="variable">Ki</span></a> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#K"><span class="id" title="variable">K</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a>)) <a class="idref" href="iris.heap_lang.proph_erasure.html#a4d9266a5be6c0504292c8910a50c288"><span class="id" title="variable">σ2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs"><span class="id" title="variable">efs</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hhstp</span> <span class="id" title="var">Hsf</span> <span class="id" title="var">He1</span> <span class="id" title="var">IH</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
</div>

<div class="doc">
Case split on whether e1 is a <span class="inlinecode"><span class="id" title="keyword">Resolve</span></span> expression. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="../html-stdpp/stdpp.base.html#decide"><span class="id" title="definition">decide</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#is_Resolve"><span class="id" title="definition">is_Resolve</span></a> <span class="id" title="var">e1</span>)); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;{ </div>

<div class="doc">
e1 is not a <span class="inlinecode"><span class="id" title="keyword">Resolve</span></span> expression. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#non_resolve_prim_step_matched_by_erased_steps_ectx_item"><span class="id" title="lemma">non_resolve_prim_step_matched_by_erased_steps_ectx_item</span></a>; <span class="id" title="tactic">eauto</span>; [|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.program_logic.ectxi_language.html#fill_not_val"><span class="id" title="lemma">fill_not_val</span></a>, <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val_head_stuck"><span class="id" title="lemma">val_head_stuck</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">eapply</span> (<span class="id" title="var">IH</span> <span class="id" title="var">K</span>); <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;</div>

<div class="doc">
e1 is a <span class="inlinecode"><span class="id" title="keyword">Resolve</span></span> expression. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Ki</span>; <span class="id" title="var">simplify_eq</span>/=;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> ?<span class="id" title="var">e</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> ?<span class="id" title="var">e'</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">progress</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>; <span class="id" title="var">simplify_eq</span>/=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">K</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">Ki</span> <span class="id" title="var">K</span> <span class="id" title="var">_</span>] <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">rev_ind</span></a>; <span class="id" title="var">simplify_eq</span>/=; [|].<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;case&nbsp;where&nbsp;(Fst&nbsp;(erase_expr&nbsp;e1_1,&nbsp;erase_expr&nbsp;e1_2,&nbsp;erase_expr&nbsp;e1_3))&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;takes&nbsp;a&nbsp;head_step;&nbsp;it&nbsp;is&nbsp;impossible!&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hhstp</span>; <span class="id" title="var">simplify_eq</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_resolve"><span class="id" title="definition">erase_resolve</span></a> <a class="idref" href="iris.program_logic.ectxi_language.html#fill_app"><span class="id" title="lemma">fill_app</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">He1</span>; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Ki</span>; <span class="id" title="var">simplify_eq</span>/=; <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.program_logic.ectxi_language.html#fill_app"><span class="id" title="lemma">fill_app</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">K</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">Ki</span> <span class="id" title="var">K</span> <span class="id" title="var">_</span>] <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">rev_ind</span></a>; <span class="id" title="var">simplify_eq</span>/=; [|].<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;case&nbsp;where&nbsp;(erase_expr&nbsp;e1_1,&nbsp;erase_expr&nbsp;e1_2,&nbsp;erase_expr&nbsp;e1_3)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;takes&nbsp;a&nbsp;head_step;&nbsp;it&nbsp;is&nbsp;impossible!&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hhstp</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.program_logic.ectxi_language.html#fill_app"><span class="id" title="lemma">fill_app</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">He1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Ki</span>; <span class="id" title="var">simplify_eq</span>/=; <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.program_logic.ectxi_language.html#fill_app"><span class="id" title="lemma">fill_app</span></a> /=.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">K</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">Ki</span> <span class="id" title="var">K</span> <span class="id" title="var">_</span>] <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">rev_ind</span></a>; <span class="id" title="var">simplify_eq</span>/=; [|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ </div>

<div class="doc">
<span class="inlinecode"><span class="id" title="keyword">Resolve</span></span> <span class="inlinecode"><a class="idref" href="iris.heap_lang.lifting.html#v0"><span class="id" title="variable">v0</span></a></span> <span class="inlinecode"><a class="idref" href="iris.base_logic.lib.gen_heap.html#v1"><span class="id" title="variable">v1</span></a></span> <span class="inlinecode"><a class="idref" href="iris.base_logic.lib.gen_heap.html#v2"><span class="id" title="variable">v2</span></a></span> is not safe! 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hhstp</span>; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> ?<span class="id" title="var">e</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>; <span class="id" title="var">simplify_eq</span>/=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> ?<span class="id" title="var">e</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>; <span class="id" title="var">simplify_eq</span>/=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">exfalso</span>; <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#Resolve_3_vals_unsafe"><span class="id" title="lemma">Resolve_3_vals_unsafe</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.program_logic.ectxi_language.html#fill_app"><span class="id" title="lemma">fill_app</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">He1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Ki</span>; <span class="id" title="var">simplify_eq</span>/=; <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.program_logic.ectxi_language.html#fill_app"><span class="id" title="lemma">fill_app</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ </div>

<div class="doc">
e1 is of the form (<span class="inlinecode"><span class="id" title="keyword">Resolve</span></span> e10 e11 v0) and e11 takes a prim_step. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hsf</span> <span class="id" title="keyword">as</span> [[? ?]| (?&amp;?&amp;?&amp;?&amp;<span class="id" title="var">Hrpstp</span>)]; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hrpstp</span> <span class="id" title="keyword">as</span> [??? <span class="id" title="var">Hrs</span> ? <span class="id" title="var">Hhstp'</span>]; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> ?<span class="id" title="var">e</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> ?<span class="id" title="var">e'</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">progress</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>; <span class="id" title="var">simplify_eq</span>/=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">edestruct</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#fill_to_resolve"><span class="id" title="lemma">fill_to_resolve</span></a> <span class="id" title="keyword">as</span> [?|[<span class="id" title="var">K'</span> [<span class="id" title="var">Ki</span> <span class="id" title="var">HK</span>]]]; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.val_head_stuck"><span class="id" title="lemma">val_head_stuck</span></a>| |]; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </div>

<div class="doc">
e1 is of the form (<span class="inlinecode"><span class="id" title="keyword">Resolve</span></span> e10 e11 v0) and e11 takes a head_step. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hhstp'</span>; <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">edestruct</span> (<span class="id" title="var">IH</span> <span class="id" title="var">K</span>) <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;<span class="id" title="var">Hpstp</span>&amp;?&amp;?&amp;?&amp;?);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a> /=; <span class="id" title="var">lia</span>|<span class="id" title="var">done</span>|<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.program_logic.ectx_language.html#head_step_not_stuck"><span class="id" title="lemma">head_step_not_stuck</span></a>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#head_reducible_prim_step"><span class="id" title="lemma">head_reducible_prim_step</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hpstp</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.program_logic.ectx_language.html#head_reducible"><span class="id" title="definition">head_reducible</span></a> /=; <span class="id" title="tactic">eauto</span> 10.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">epose</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <span class="id" title="var">H</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.lang.html#head_step_to_val"><span class="id" title="lemma">head_step_to_val</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#H"><span class="id" title="variable">H</span></a> <span class="id" title="var">Hpstp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">Hhstv</span>; <span class="id" title="var">edestruct</span> <span class="id" title="var">Hhstv</span> <span class="id" title="keyword">as</span> [? ?%<a class="idref" href="iris.heap_lang.lang.html#heap_lang.of_to_val"><span class="id" title="lemma">of_to_val</span></a>]; [<span class="id" title="var">done</span>|<span class="id" title="tactic">eauto</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span> (<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#head_prim_step"><span class="id" title="lemma">head_prim_step</span></a>; <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">etrans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="iris.program_logic.language.html#rtc_pure_step_ctx"><span class="id" title="lemma">rtc_pure_step_ctx</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairLCtx"><span class="id" title="constructor">PairLCtx</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairLCtx"><span class="id" title="constructor">PairLCtx</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#projs_pure_steps"><span class="id" title="lemma">projs_pure_steps</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* </div>

<div class="doc">
e1 is of the form (<span class="inlinecode"><span class="id" title="keyword">Resolve</span></span> e10 v v0) and e10 takes a
           (non-head) prim_step. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.program_logic.ectxi_language.html#fill_app"><span class="id" title="lemma">fill_app</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hrs</span>; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">edestruct</span> (<span class="id" title="var">IH</span> <span class="id" title="var">K</span>) <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;<span class="id" title="var">Hpstp</span>&amp;<span class="id" title="var">Hprstps</span>&amp;?&amp;?&amp;?);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a>; <span class="id" title="var">lia</span>|<span class="id" title="var">done</span>| |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">change</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.fill_item"><span class="id" title="definition">fill_item</span></a> <span class="id" title="var">Ki</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">Ki</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.ectxi_language.html#fill_app"><span class="id" title="lemma">fill_app</span></a>; <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.program_logic.language.html#prim_step_not_stuck"><span class="id" title="lemma">prim_step_not_stuck</span></a>, <a class="idref" href="iris.program_logic.ectx_language.html#Ectx_step"><span class="id" title="constructor">Ectx_step</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.fill_item"><span class="id" title="definition">fill_item</span></a> <span class="id" title="var">Ki</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">Ki</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hpstp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="iris.program_logic.ectxi_language.html#fill_app"><span class="id" title="lemma">fill_app</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hpstp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="iris.program_logic.ectx_language.html#head_reducible_prim_step_ctx"><span class="id" title="lemma">head_reducible_prim_step_ctx</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hpstp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">e2''</span> [<span class="id" title="var">He2''</span> <span class="id" title="var">Hpstp</span>]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">apply</span> (<a class="idref" href="iris.program_logic.ectx_language.html#fill_prim_step"><span class="id" title="lemma">fill_prim_step</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.ResolveLCtx"><span class="id" title="constructor">ResolveLCtx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>); <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.program_logic.ectx_language.html#Ectx_step"><span class="id" title="constructor">Ectx_step</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.program_logic.ectxi_language.html#fill_app"><span class="id" title="lemma">fill_app</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hprstps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="iris.program_logic.language.html#rtc_pure_step_ctx"><span class="id" title="lemma">rtc_pure_step_ctx</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairLCtx"><span class="id" title="constructor">PairLCtx</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairLCtx"><span class="id" title="constructor">PairLCtx</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ </div>

<div class="doc">
e1 is of the form (<span class="inlinecode"><span class="id" title="keyword">Resolve</span></span> e1 e1_2 v) and e1_2 takes a prim_step. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> ?<span class="id" title="var">e</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> ?<span class="id" title="var">e'</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">progress</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>; <span class="id" title="var">simplify_eq</span>/=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="iris.heap_lang.proph_erasure.html#prim_step_matched_by_erased_steps_ectx"><span class="id" title="lemma">prim_step_matched_by_erased_steps_ectx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.ResolveMCtx"><span class="id" title="constructor">ResolveMCtx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a> /=; <span class="id" title="var">lia</span>|<span class="id" title="var">done</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.program_logic.language.html#not_stuck_fill_inv"><span class="id" title="lemma">not_stuck_fill_inv</span></a> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.ResolveMCtx"><span class="id" title="constructor">ResolveMCtx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>)); <span class="id" title="tactic">simpl</span>].<br/>
&nbsp;&nbsp;- </div>

<div class="doc">
e1 is of the form (<span class="inlinecode"><span class="id" title="keyword">Resolve</span></span> e1 e1_2 e13) and e1_3 takes a prim_step. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="iris.heap_lang.proph_erasure.html#prim_step_matched_by_erased_steps_ectx"><span class="id" title="lemma">prim_step_matched_by_erased_steps_ectx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.ResolveRCtx"><span class="id" title="constructor">ResolveRCtx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>; [<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a> /=; <span class="id" title="var">lia</span>|<span class="id" title="var">done</span>|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="iris.program_logic.language.html#not_stuck_fill_inv"><span class="id" title="lemma">not_stuck_fill_inv</span></a> (<a class="idref" href="iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.ResolveRCtx"><span class="id" title="constructor">ResolveRCtx</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>)); <span class="id" title="tactic">simpl</span>].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="erased_prim_step_prim_step"><span class="id" title="lemma">erased_prim_step_prim_step</span></a> <span class="id" title="var">e1</span> σ1 <span class="id" title="var">κ</span> <span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="iris.program_logic.ectx_language.html#prim_step"><span class="id" title="inductive">prim_step</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a>) <a class="idref" href="iris.heap_lang.proph_erasure.html#29d7d9bf2d713ce949c9fed315ed8ffb"><span class="id" title="variable">κ</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#a4d9266a5be6c0504292c8910a50c288"><span class="id" title="variable">σ2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.program_logic.language.html#not_stuck"><span class="id" title="definition">not_stuck</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#prim_step_matched_by_erased_steps"><span class="id" title="definition">prim_step_matched_by_erased_steps</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#a4d9266a5be6c0504292c8910a50c288"><span class="id" title="variable">σ2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#efs"><span class="id" title="variable">efs</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hstp</span> <span class="id" title="var">He1sf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hstp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">K</span> <span class="id" title="var">e1'</span> <span class="id" title="var">e2'</span> <span class="id" title="var">He1</span> ? <span class="id" title="var">Hhstp</span>]; <span class="id" title="tactic">clear</span> <span class="id" title="var">Hstp</span>; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">len</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <span class="id" title="var">K</span>); <span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <span class="id" title="var">K</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">len</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hlen</span> <span class="id" title="tactic">by</span> <span class="id" title="var">done</span>; <span class="id" title="var">clearbody</span> <span class="id" title="var">len</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">K</span> <span class="id" title="var">Hlen</span> <span class="id" title="var">e1</span> <span class="id" title="var">He1</span> <span class="id" title="var">He1sf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">len</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">m</span> <span class="id" title="var">IHm</span>]<span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Arith.Wf_nat.html#lt_wf_ind"><span class="id" title="lemma">lt_wf_ind</span></a>; <span class="id" title="tactic">intros</span> <span class="id" title="var">K</span> <span class="id" title="var">Hlen</span> <span class="id" title="var">e1</span> <span class="id" title="var">He1</span> <span class="id" title="var">He1sf</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">K</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">Ki</span> <span class="id" title="var">K</span> <span class="id" title="var">_</span>] <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">rev_ind</span></a>; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#erased_head_step_head_step"><span class="id" title="lemma">erased_head_step_head_step</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hhstp</span> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;&lt;-&amp;?&amp;&lt;-).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span> (<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#head_prim_step"><span class="id" title="lemma">head_prim_step</span></a>); <span class="id" title="tactic">auto</span> <span class="id" title="keyword">using</span> <a class="idref" href="../html-stdpp/stdpp.relations.html#rtc_refl"><span class="id" title="constructor">rtc_refl</span></a>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#app_length"><span class="id" title="lemma">app_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IHm</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.program_logic.ectxi_language.html#fill_app"><span class="id" title="lemma">fill_app</span></a> /=; <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.program_logic.ectxi_language.html#fill_app"><span class="id" title="lemma">fill_app</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">He1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#prim_step_matched_by_erased_steps_ectx_item"><span class="id" title="lemma">prim_step_matched_by_erased_steps_ectx_item</span></a>; <span class="id" title="tactic">eauto</span>; [].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHm</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <span class="id" title="var">K'</span>)); <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">lia</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="head_step_erased_prim_step_CmpXchg"><span class="id" title="lemma">head_step_erased_prim_step_CmpXchg</span></a> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> σ <span class="id" title="var">l</span> <span class="id" title="var">vl</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap"><span class="id" title="projection">heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#vl"><span class="id" title="variable">vl</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#vl"><span class="id" title="variable">vl</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">e2'</span> σ2' <span class="id" title="var">ef'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.program_logic.ectx_language.html#prim_step"><span class="id" title="inductive">prim_step</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v1"><span class="id" title="variable">v1</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v2"><span class="id" title="variable">v2</span></a>)) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2'"><span class="id" title="variable">e2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#502bfca0bbef2195c0a48cb6ed5249c6"><span class="id" title="variable">σ2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#ef'"><span class="id" title="variable">ef'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hl</span> <span class="id" title="var">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="../html-stdpp/stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<span class="id" title="var">vl</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">v1</span>)) <span class="id" title="var">eqn</span>:<span class="id" title="var">Heqvls</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#head_prim_step"><span class="id" title="lemma">head_prim_step</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>; [|<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#vals_compare_safe_erase"><span class="id" title="lemma">vals_compare_safe_erase</span></a>|<span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> /<a class="idref" href="iris.heap_lang.lang.html#heap_lang.state_upd_heap"><span class="id" title="definition">state_upd_heap</span></a> /= <a class="idref" href="iris.heap_lang.proph_erasure.html#lookup_erase_heap"><span class="id" title="lemma">lookup_erase_heap</span></a> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#head_prim_step"><span class="id" title="lemma">head_prim_step</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>; [|<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#vals_compare_safe_erase"><span class="id" title="lemma">vals_compare_safe_erase</span></a>|<span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> /<a class="idref" href="iris.heap_lang.lang.html#heap_lang.state_upd_heap"><span class="id" title="definition">state_upd_heap</span></a> /= <a class="idref" href="iris.heap_lang.proph_erasure.html#lookup_erase_heap"><span class="id" title="lemma">lookup_erase_heap</span></a> <span class="id" title="var">Hl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="head_step_erased_prim_step_resolve"><span class="id" title="lemma">head_step_erased_prim_step_resolve</span></a> <span class="id" title="var">e</span> <span class="id" title="var">w</span> σ :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">e2'</span> σ2' <span class="id" title="var">ef'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.program_logic.ectx_language.html#prim_step"><span class="id" title="inductive">prim_step</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2'"><span class="id" title="variable">e2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#502bfca0bbef2195c0a48cb6ed5249c6"><span class="id" title="variable">σ2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#ef'"><span class="id" title="variable">ef'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">e2'</span> σ2' <span class="id" title="var">ef'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.program_logic.ectx_language.html#prim_step"><span class="id" title="inductive">prim_step</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_resolve"><span class="id" title="definition">erase_resolve</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.LitPoison"><span class="id" title="constructor">LitPoison</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#w"><span class="id" title="variable">w</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2'"><span class="id" title="variable">e2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#502bfca0bbef2195c0a48cb6ed5249c6"><span class="id" title="variable">σ2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#ef'"><span class="id" title="variable">ef'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (?&amp;?&amp;?&amp;?).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="iris.program_logic.ectx_language.html#fill_prim_step"><span class="id" title="lemma">fill_prim_step</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairLCtx"><span class="id" title="constructor">PairLCtx</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.PairLCtx"><span class="id" title="constructor">PairLCtx</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.FstCtx"><span class="id" title="constructor">FstCtx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="head_step_erased_prim_step_un_op"><span class="id" title="lemma">head_step_erased_prim_step_un_op</span></a> σ <span class="id" title="var">op</span> <span class="id" title="var">v</span> <span class="id" title="var">v'</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.un_op_eval"><span class="id" title="definition">un_op_eval</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#op"><span class="id" title="variable">op</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v'"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">e2'</span> σ2' <span class="id" title="var">ef'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.program_logic.ectx_language.html#prim_step"><span class="id" title="inductive">prim_step</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.UnOp"><span class="id" title="constructor">UnOp</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#op"><span class="id" title="variable">op</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>)) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2'"><span class="id" title="variable">e2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#502bfca0bbef2195c0a48cb6ed5249c6"><span class="id" title="variable">σ2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#ef'"><span class="id" title="variable">ef'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#head_prim_step"><span class="id" title="lemma">head_prim_step</span></a>; <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#un_op_eval_erase"><span class="id" title="lemma">un_op_eval_erase</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="head_step_erased_prim_step_bin_op"><span class="id" title="lemma">head_step_erased_prim_step_bin_op</span></a> σ <span class="id" title="var">op</span> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> <span class="id" title="var">v'</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.bin_op_eval"><span class="id" title="definition">bin_op_eval</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#op"><span class="id" title="variable">op</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v1"><span class="id" title="variable">v1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v2"><span class="id" title="variable">v2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v'"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">e2'</span> σ2' <span class="id" title="var">ef'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.program_logic.ectx_language.html#prim_step"><span class="id" title="inductive">prim_step</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.BinOp"><span class="id" title="constructor">BinOp</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#op"><span class="id" title="variable">op</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v1"><span class="id" title="variable">v1</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v2"><span class="id" title="variable">v2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2'"><span class="id" title="variable">e2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#502bfca0bbef2195c0a48cb6ed5249c6"><span class="id" title="variable">σ2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#ef'"><span class="id" title="variable">ef'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#head_prim_step"><span class="id" title="lemma">head_prim_step</span></a>; <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#bin_op_eval_erase"><span class="id" title="lemma">bin_op_eval_erase</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="head_step_erased_prim_step_allocN"><span class="id" title="lemma">head_step_erased_prim_step_allocN</span></a> σ <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">v</span>:<br/>
&nbsp;&nbsp;0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.ZArith.BinInt.html#143d73f5a64447681988da92e84a3de5"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <span class="id" title="var">i</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> 0 <a class="idref" href="../html-stdpp/stdpp.numbers.html#4ba61b06dfba8efe2fde3e31f9b023d3"><span class="id" title="notation">≤</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.ZArith.BinInt.html#143d73f5a64447681988da92e84a3de5"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap"><span class="id" title="projection">heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">(</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.locations.html#bc1cab6cf9386d7d54258da29afab04c"><span class="id" title="notation">+ₗ</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#i"><span class="id" title="variable">i</span></a><a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">e2'</span> σ2' <span class="id" title="var">ef'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.program_logic.ectx_language.html#prim_step"><span class="id" title="inductive">prim_step</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.AllocN"><span class="id" title="constructor">AllocN</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#n"><span class="id" title="variable">n</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>)) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2'"><span class="id" title="variable">e2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#502bfca0bbef2195c0a48cb6ed5249c6"><span class="id" title="variable">σ2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#ef'"><span class="id" title="variable">ef'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#head_prim_step"><span class="id" title="lemma">head_prim_step</span></a>; <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#lookup_erase_heap_None"><span class="id" title="lemma">lookup_erase_heap_None</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="head_step_erased_prim_step_load"><span class="id" title="lemma">head_step_erased_prim_step_load</span></a> σ <span class="id" title="var">l</span> <span class="id" title="var">v</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap"><span class="id" title="projection">heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">e2'</span> σ2' <span class="id" title="var">ef'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.program_logic.ectx_language.html#prim_step"><span class="id" title="inductive">prim_step</span></a> (<a class="idref" href="iris.heap_lang.notation.html#569b74bc432a2b233b93ae1b45418e26"><span class="id" title="notation">!</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2'"><span class="id" title="variable">e2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#502bfca0bbef2195c0a48cb6ed5249c6"><span class="id" title="variable">σ2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#ef'"><span class="id" title="variable">ef'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#head_prim_step"><span class="id" title="lemma">head_prim_step</span></a>; <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> /<a class="idref" href="iris.heap_lang.lang.html#heap_lang.state_upd_heap"><span class="id" title="definition">state_upd_heap</span></a> /= <a class="idref" href="iris.heap_lang.proph_erasure.html#lookup_erase_heap"><span class="id" title="lemma">lookup_erase_heap</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <a class="idref" href="../html-stdpp/stdpp.base.html#lookup"><span class="id" title="definition">lookup</span></a>; <span class="id" title="var">simplify_eq</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="head_step_erased_prim_step_store"><span class="id" title="lemma">head_step_erased_prim_step_store</span></a> σ <span class="id" title="var">l</span> <span class="id" title="var">v</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="../html-stdpp/stdpp.option.html#is_Some"><span class="id" title="definition">is_Some</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap"><span class="id" title="projection">heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">e2'</span> σ2' <span class="id" title="var">ef'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.program_logic.ectx_language.html#prim_step"><span class="id" title="inductive">prim_step</span></a> (<a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.notation.html#c86a93f3678d40e29f281dd490cfc181"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2'"><span class="id" title="variable">e2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#502bfca0bbef2195c0a48cb6ed5249c6"><span class="id" title="variable">σ2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#ef'"><span class="id" title="variable">ef'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">w</span> <span class="id" title="var">Hw</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#head_prim_step"><span class="id" title="lemma">head_prim_step</span></a>; <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> /<a class="idref" href="iris.heap_lang.lang.html#heap_lang.state_upd_heap"><span class="id" title="definition">state_upd_heap</span></a> /= <a class="idref" href="iris.heap_lang.proph_erasure.html#lookup_erase_heap"><span class="id" title="lemma">lookup_erase_heap</span></a> <span class="id" title="var">Hw</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="head_step_erased_prim_step_FAA"><span class="id" title="lemma">head_step_erased_prim_step_FAA</span></a> σ <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">n'</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.heap"><span class="id" title="projection">heap</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">e2'</span> σ2' <span class="id" title="var">ef'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.program_logic.ectx_language.html#prim_step"><span class="id" title="inductive">prim_step</span></a> (<a class="idref" href="iris.heap_lang.lang.html#heap_lang.FAA"><span class="id" title="constructor">FAA</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="iris.heap_lang.notation.html#66e8f9d9f9894a066beff0d1c67d3c77"><span class="id" title="notation">#</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#n'"><span class="id" title="variable">n'</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2'"><span class="id" title="variable">e2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#502bfca0bbef2195c0a48cb6ed5249c6"><span class="id" title="variable">σ2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#ef'"><span class="id" title="variable">ef'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#head_prim_step"><span class="id" title="lemma">head_prim_step</span></a>. <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> /<a class="idref" href="iris.heap_lang.lang.html#heap_lang.state_upd_heap"><span class="id" title="definition">state_upd_heap</span></a> /= <a class="idref" href="iris.heap_lang.proph_erasure.html#lookup_erase_heap"><span class="id" title="lemma">lookup_erase_heap</span></a> <span class="id" title="var">Hl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="keyword">Resolve</span></span> is translated as a projection out of a triple.
Therefore, when resolve takes a head step, the erasure of <span class="inlinecode"><span class="id" title="keyword">Resolve</span></span> takes a
prim step inside the triple.

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="head_step_erased_prim_step"><span class="id" title="lemma">head_step_erased_prim_step</span></a> <span class="id" title="var">e1</span> σ1 <span class="id" title="var">κ</span> <span class="id" title="var">e2</span> σ2 <span class="id" title="var">ef</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.lang.html#heap_lang.head_step"><span class="id" title="inductive">head_step</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#29d7d9bf2d713ce949c9fed315ed8ffb"><span class="id" title="variable">κ</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#a4d9266a5be6c0504292c8910a50c288"><span class="id" title="variable">σ2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#ef"><span class="id" title="variable">ef</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">e2'</span> σ2' <span class="id" title="var">ef'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.program_logic.ectx_language.html#prim_step"><span class="id" title="inductive">prim_step</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#1cc6be414ab52727f77057b4b030dde0"><span class="id" title="variable">σ1</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2'"><span class="id" title="variable">e2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#502bfca0bbef2195c0a48cb6ed5249c6"><span class="id" title="variable">σ2'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#ef'"><span class="id" title="variable">ef'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> 1; <span class="id" title="var">simplify_eq</span>/=;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#head_step_erased_prim_step_CmpXchg"><span class="id" title="lemma">head_step_erased_prim_step_CmpXchg</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#head_step_erased_prim_step_resolve"><span class="id" title="lemma">head_step_erased_prim_step_resolve</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#head_step_erased_prim_step_un_op"><span class="id" title="lemma">head_step_erased_prim_step_un_op</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#head_step_erased_prim_step_bin_op"><span class="id" title="lemma">head_step_erased_prim_step_bin_op</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#head_step_erased_prim_step_allocN"><span class="id" title="lemma">head_step_erased_prim_step_allocN</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#head_step_erased_prim_step_load"><span class="id" title="lemma">head_step_erased_prim_step_load</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#head_step_erased_prim_step_store"><span class="id" title="lemma">head_step_erased_prim_step_store</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#head_step_erased_prim_step_FAA"><span class="id" title="lemma">head_step_erased_prim_step_FAA</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="iris.program_logic.ectx_language.html#head_prim_step"><span class="id" title="lemma">head_prim_step</span></a>; <span class="id" title="tactic">econstructor</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="reducible_erased_reducible"><span class="id" title="lemma">reducible_erased_reducible</span></a> <span class="id" title="var">e</span> σ :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.program_logic.language.html#reducible"><span class="id" title="definition">reducible</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.program_logic.language.html#reducible"><span class="id" title="definition">reducible</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> (?&amp;?&amp;?&amp;?&amp;<span class="id" title="var">Hpstp</span>); <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hpstp</span>; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_ectx_expr"><span class="id" title="lemma">erase_ectx_expr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">edestruct</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#head_step_erased_prim_step"><span class="id" title="lemma">head_step_erased_prim_step</span></a> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;?); <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>; <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.program_logic.ectx_language.html#fill_prim_step"><span class="id" title="lemma">fill_prim_step</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="pure_step_tp_safe"><span class="id" title="lemma">pure_step_tp_safe</span></a> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">e1</span> σ :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <span class="id" title="var">e2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#2a78afea1eeed082be084d2a55e1605c"><span class="id" title="notation">∈</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#t2"><span class="id" title="variable">t2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.program_logic.language.html#not_stuck"><span class="id" title="definition">not_stuck</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.program_logic.language.html#pure_steps_tp"><span class="id" title="abbreviation">pure_steps_tp</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#t1"><span class="id" title="variable">t1</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_tp"><span class="id" title="definition">erase_tp</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#t2"><span class="id" title="variable">t2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="../html-stdpp/stdpp.base.html#2a78afea1eeed082be084d2a55e1605c"><span class="id" title="notation">∈</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#t1"><span class="id" title="variable">t1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="iris.program_logic.language.html#not_stuck"><span class="id" title="definition">not_stuck</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e1"><span class="id" title="variable">e1</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Ht2</span> <span class="id" title="var">Hpr</span> [<span class="id" title="var">i</span> <span class="id" title="var">He1</span>]%<a class="idref" href="../html-stdpp/stdpp.list.html#elem_of_list_lookup_1"><span class="id" title="lemma">elem_of_list_lookup_1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="../html-stdpp/stdpp.list.html#Forall2_lookup_l"><span class="id" title="lemma">Forall2_lookup_l</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hpr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">e2'</span> [<span class="id" title="var">He2'</span> <span class="id" title="var">Hpr</span>]]; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_tp"><span class="id" title="definition">erase_tp</span></a> <a class="idref" href="../html-stdpp/stdpp.list.html#list_lookup_fmap"><span class="id" title="lemma">list_lookup_fmap</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">He2'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">t2</span> <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <span class="id" title="var">i</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">He2</span>; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="../html-stdpp/stdpp.list.html#elem_of_list_lookup_2"><span class="id" title="lemma">elem_of_list_lookup_2</span></a>, <span class="id" title="var">Ht2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">He2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">Hpr</span> <span class="id" title="var">He2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hpr</span> <span class="id" title="keyword">as</span> [|??? [? <span class="id" title="var">_</span>]]; <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">He2</span> <span class="id" title="keyword">as</span> [[? ?%<a class="idref" href="iris.heap_lang.lang.html#heap_lang.of_to_val"><span class="id" title="lemma">of_to_val</span></a>]|]; <span class="id" title="var">simplify_eq</span>/=; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">left</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">right</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#reducible_erased_reducible"><span class="id" title="lemma">reducible_erased_reducible</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">right</span>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <a class="idref" href="iris.program_logic.language.html#reducible_no_obs_reducible"><span class="id" title="lemma">reducible_no_obs_reducible</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
This is the top-level erasure theorem: erasure preserves adequacy. 
</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a name="erasure"><span class="id" title="lemma">erasure</span></a> <span class="id" title="var">e</span> σ φ :<br/>
&nbsp;&nbsp;<a class="idref" href="iris.program_logic.adequacy.html#adequate"><span class="id" title="record">adequate</span></a> <a class="idref" href="iris.bi.weakestpre.html#NotStuck"><span class="id" title="constructor">NotStuck</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#7f48d4a68765673379b41e1b1ee20edf"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="iris.program_logic.adequacy.html#adequate"><span class="id" title="record">adequate</span></a> <a class="idref" href="iris.bi.weakestpre.html#NotStuck"><span class="id" title="constructor">NotStuck</span></a> (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#e"><span class="id" title="variable">e</span></a>) (<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <span class="id" title="var">v</span> σ<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">v'</span> σ'<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_val"><span class="id" title="definition">erase_val</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v'"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#4394a2ef16b8915a5209b8b27258ea45"><span class="id" title="variable">σ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#7f48d4a68765673379b41e1b1ee20edf"><span class="id" title="variable">φ</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#v'"><span class="id" title="variable">v'</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#4394a2ef16b8915a5209b8b27258ea45"><span class="id" title="variable">σ'</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">Hade</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">cut</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <span class="id" title="var">t2</span> σ2<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="../html-stdpp/stdpp.relations.html#rtc"><span class="id" title="inductive">rtc</span></a> <a class="idref" href="iris.program_logic.language.html#erased_step"><span class="id" title="definition">erased_step</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#erase_expr"><span class="id" title="definition">erase_expr</span></a> <span class="id" title="var">e</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> σ<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#t2"><span class="id" title="variable">t2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#a4d9266a5be6c0504292c8910a50c288"><span class="id" title="variable">σ2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <span class="id" title="var">t2'</span> <span class="id" title="var">t2''</span> σ2'<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="../html-stdpp/stdpp.relations.html#rtc"><span class="id" title="inductive">rtc</span></a> <a class="idref" href="iris.program_logic.language.html#erased_step"><span class="id" title="definition">erased_step</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">e</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> σ<a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="iris.heap_lang.proph_erasure.html#t2''"><span class="id" title="variable">t2''</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#502bfca0bbef2195c0a48cb6ed5249c6"><span class="id" title="variable">σ2'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.heap_lang.proph_erasure.html#t2'"><span class="id" title="variable">t2'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_tp"><span class="id" title="definition">erase_tp</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#t2''"><span class="id" title="variable">t2''</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#a4d9266a5be6c0504292c8910a50c288"><span class="id" title="variable">σ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_state"><span class="id" title="definition">erase_state</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#502bfca0bbef2195c0a48cb6ed5249c6"><span class="id" title="variable">σ2'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="iris.program_logic.language.html#pure_steps_tp"><span class="id" title="abbreviation">pure_steps_tp</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#t2"><span class="id" title="variable">t2</span></a> <a class="idref" href="iris.heap_lang.proph_erasure.html#t2'"><span class="id" title="variable">t2'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">Hreach</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> ? ? ? <span class="id" title="var">Hrtc</span>; <span class="id" title="var">edestruct</span> (<span class="id" title="var">Hreach</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hrtc</span>) <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">t2'</span>&amp;<span class="id" title="var">t2''</span>&amp;σ2'&amp;<span class="id" title="var">Hos</span>&amp;<span class="id" title="var">Ht2'</span>&amp;<span class="id" title="var">H</span>σ2&amp;<span class="id" title="var">Hptp</span>); <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="../html-stdpp/stdpp.list.html#Forall2_cons_inv_l"><span class="id" title="lemma">Forall2_cons_inv_l</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hptp</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">oe</span>&amp;<span class="id" title="var">t3</span>&amp;<span class="id" title="var">Hoe</span>%<a class="idref" href="iris.program_logic.language.html#rtc_pure_step_val"><span class="id" title="lemma">rtc_pure_step_val</span></a>&amp;<span class="id" title="var">_</span>&amp;?);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t2''</span>; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#erase_to_val"><span class="id" title="lemma">erase_to_val</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hoe</span> <span class="id" title="keyword">as</span> (?&amp;?%<a class="idref" href="iris.heap_lang.lang.html#heap_lang.of_to_val"><span class="id" title="lemma">of_to_val</span></a>&amp;?); <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="iris.program_logic.adequacy.html#adequate_result"><span class="id" title="projection">adequate_result</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hade</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hos</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> ? ? ? <span class="id" title="var">Hs</span> <span class="id" title="var">Hrtc</span> <span class="id" title="var">He2</span>; <span class="id" title="var">edestruct</span> (<span class="id" title="var">Hreach</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hrtc</span>) <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">t2'</span>&amp;<span class="id" title="var">t2''</span>&amp;σ2'&amp;<span class="id" title="var">Hos</span>&amp;<span class="id" title="var">Ht2'</span>&amp;<span class="id" title="var">H</span>σ2&amp;<span class="id" title="var">Hptp</span>); <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#pure_step_tp_safe"><span class="id" title="lemma">pure_step_tp_safe</span></a>; [|<span class="id" title="var">done</span>..].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">e2'</span> <span class="id" title="var">He2'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="iris.program_logic.adequacy.html#adequate_not_stuck"><span class="id" title="projection">adequate_not_stuck</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hade</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a> <span class="id" title="var">Hos</span> <span class="id" title="var">He2'</span>). }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t2</span> σ2 [<span class="id" title="var">n</span> <span class="id" title="var">Hstps</span>]%<a class="idref" href="../html-stdpp/stdpp.relations.html#rtc_nsteps"><span class="id" title="lemma">rtc_nsteps</span></a>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">revert</span> <span class="id" title="var">t2</span> σ2 <span class="id" title="var">Hstps</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">t2</span> σ2 <span class="id" title="var">Hstps</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hstps</span>; <span class="id" title="var">simplify_eq</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">econstructor</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t2</span> σ2 <span class="id" title="var">Hstps</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="../html-stdpp/stdpp.relations.html#nsteps_inv_r"><span class="id" title="lemma">nsteps_inv_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstps</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">t3</span> σ3] [<span class="id" title="var">Hstps</span> <span class="id" title="var">H</span>ρ]]; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHn</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hstps</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">t2'</span>&amp;<span class="id" title="var">t2''</span>&amp;σ2'&amp;<span class="id" title="var">Hostps</span>&amp;?&amp;?&amp;<span class="id" title="var">Hprstps</span>); <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">edestruct</span> @<a class="idref" href="iris.program_logic.language.html#erased_step_pure_step_tp"><span class="id" title="lemma">erased_step_pure_step_tp</span></a> <span class="id" title="keyword">as</span> [[? <span class="id" title="keyword">Hint</span>]|<span class="id" title="var">Hext</span>]; <span class="id" title="var">simplify_eq</span>/=;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span> 10; [|<span class="id" title="var">done</span>..].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hext</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">i</span>&amp;<span class="id" title="var">ei</span>&amp;<span class="id" title="var">t2'</span>&amp;<span class="id" title="var">efs</span>&amp;<span class="id" title="var">e'</span>&amp;<span class="id" title="var">κ</span>&amp;<span class="id" title="var">Hi1</span>&amp;<span class="id" title="var">Ht2</span>&amp;<span class="id" title="var">Hpstp</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_tp"><span class="id" title="definition">erase_tp</span></a> <a class="idref" href="../html-stdpp/stdpp.list.html#list_lookup_fmap"><span class="id" title="lemma">list_lookup_fmap</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hi1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">t2''</span> <a class="idref" href="../html-stdpp/stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <span class="id" title="var">i</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">eio</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>; <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;<span class="id" title="var">edestruct</span> <a class="idref" href="iris.heap_lang.proph_erasure.html#erased_prim_step_prim_step"><span class="id" title="lemma">erased_prim_step_prim_step</span></a> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">eio'</span> &amp; σ3 &amp; <span class="id" title="var">κ'</span> &amp; <span class="id" title="var">efs'</span> &amp; <span class="id" title="var">ee</span> &amp; <span class="id" title="var">Heiopstp</span> &amp; <span class="id" title="var">Hprstps'</span> &amp; ?&amp;?&amp;?); <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">last</span> <span class="id" title="var">simplify_eq</span>/=.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="iris.program_logic.adequacy.html#adequate_not_stuck"><span class="id" title="projection">adequate_not_stuck</span></a>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <a class="idref" href="../html-stdpp/stdpp.list.html#elem_of_list_lookup_2"><span class="id" title="lemma">elem_of_list_lookup_2</span></a>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>; <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">etrans</span>; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="../html-stdpp/stdpp.relations.html#rtc_once"><span class="id" title="lemma">rtc_once</span></a>; <span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="iris.program_logic.language.html#step_insert"><span class="id" title="lemma">step_insert</span></a>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_tp"><span class="id" title="definition">erase_tp</span></a> <a class="idref" href="../html-stdpp/stdpp.list.html#fmap_app"><span class="id" title="lemma">fmap_app</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="../html-stdpp/stdpp.list.html#list_fmap_insert"><span class="id" title="lemma">list_fmap_insert</span></a>/=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Lists.List.html#Forall2_app"><span class="id" title="lemma">Forall2_app</span></a>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="../html-stdpp/stdpp.list.html#Forall2_same_length_lookup"><span class="id" title="lemma">Forall2_same_length_lookup</span></a>; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="../html-stdpp/stdpp.list.html#Forall2_length"><span class="id" title="lemma">Forall2_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hprstps</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="../html-stdpp/stdpp.list.html#fmap_length"><span class="id" title="lemma">fmap_length</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hprstps</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="../html-stdpp/stdpp.list.html#insert_length"><span class="id" title="lemma">insert_length</span></a> <a class="idref" href="../html-stdpp/stdpp.list.html#fmap_length"><span class="id" title="lemma">fmap_length</span></a>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="../html-stdpp/stdpp.base.html#decide"><span class="id" title="definition">decide</span></a> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">j</span>)); <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> !<a class="idref" href="../html-stdpp/stdpp.list.html#list_lookup_insert"><span class="id" title="lemma">list_lookup_insert</span></a> ?<a class="idref" href="../html-stdpp/stdpp.list.html#fmap_length"><span class="id" title="lemma">fmap_length</span></a>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <a class="idref" href="../html-stdpp/stdpp.list.html#lookup_lt_Some"><span class="id" title="lemma">lookup_lt_Some</span></a>; [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> ? ?; <span class="id" title="var">simplify_eq</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="../html-stdpp/stdpp.list.html#list_lookup_insert_ne"><span class="id" title="lemma">list_lookup_insert_ne</span></a> // <a class="idref" href="../html-stdpp/stdpp.list.html#list_lookup_fmap"><span class="id" title="lemma">list_lookup_fmap</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? ?.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="../html-stdpp/stdpp.list.html#Forall2_lookup_lr"><span class="id" title="lemma">Forall2_lookup_lr</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="iris.heap_lang.proph_erasure.html#erase_tp"><span class="id" title="definition">erase_tp</span></a> <a class="idref" href="../html-stdpp/stdpp.list.html#list_lookup_fmap"><span class="id" title="lemma">list_lookup_fmap</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
